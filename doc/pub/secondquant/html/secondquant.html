<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="PHY 981 Nuclear Structure: Second Quantization">

<title>PHY 981 Nuclear Structure: Second Quantization</title>


<style type="text/css">
/* bloodish style */

body {
  font-family: Helvetica, Verdana, Arial, Sans-serif;
  color: #404040;
  background: #ffffff;
}
h1 { font-size: 1.8em;  color: #8A0808; }
h2 { font-size: 1.6em;  color: #8A0808; }
h3 { font-size: 1.4em;  color: #8A0808; }
h4 { color: #8A0808; }
a { color: #8A0808; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #bababa;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #f8f8f8;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Second quantization', 2, None, '___sec0'),
              ('Second quantization', 2, None, '___sec1'),
              ('Second quantization', 2, None, '___sec2'),
              ('Second quantization', 2, None, '___sec3'),
              ('Second quantization', 2, None, '___sec4'),
              ('Second quantization', 2, None, '___sec5'),
              ('Second quantization', 2, None, '___sec6'),
              ('Second quantization', 2, None, '___sec7'),
              ('Second quantization', 2, None, '___sec8'),
              ('Second quantization', 2, None, '___sec9'),
              ('Second quantization', 2, None, '___sec10'),
              ('Second quantization', 2, None, '___sec11'),
              ('Second quantization', 2, None, '___sec12'),
              ('Second quantization', 2, None, '___sec13'),
              ('Second quantization', 2, None, '___sec14'),
              ('Second quantization', 2, None, '___sec15'),
              ('Second quantization', 2, None, '___sec16'),
              ('Second quantization', 2, None, '___sec17'),
              ('Second quantization', 2, None, '___sec18'),
              ('Second quantization', 2, None, '___sec19'),
              ('Second quantization', 2, None, '___sec20'),
              ('Second quantization', 2, None, '___sec21'),
              ('Second quantization', 2, None, '___sec22'),
              ('Second quantization', 2, None, '___sec23'),
              ('Second quantization', 2, None, '___sec24'),
              ('Second quantization', 2, None, '___sec25'),
              ('Second quantization', 2, None, '___sec26'),
              ('Second quantization', 2, None, '___sec27'),
              ('Second quantization', 2, None, '___sec28'),
              ('Two-body operators in second quantization',
               2,
               None,
               '___sec29'),
              ('Operators in second quantization', 2, None, '___sec30'),
              ('Operators in second quantization', 2, None, '___sec31'),
              ('Operators in second quantization', 2, None, '___sec32'),
              ('Operators in second quantization', 2, None, '___sec33'),
              ('Operators in second quantization', 2, None, '___sec34'),
              ('Operators in second quantization', 2, None, '___sec35'),
              ('Operators in second quantization', 2, None, '___sec36'),
              ('Operators in second quantization', 2, None, '___sec37'),
              ('Operators in second quantization', 2, None, '___sec38'),
              ('Operators in second quantization', 2, None, '___sec39'),
              ('Operators in second quantization', 2, None, '___sec40'),
              ('Operators in second quantization', 2, None, '___sec41'),
              ('Particle-hole formalism', 2, None, '___sec42'),
              ('Particle-hole formalism', 2, None, '___sec43'),
              ('Particle-hole formalism', 2, None, '___sec44'),
              ('Particle-hole formalism', 2, None, '___sec45'),
              ('Particle-hole formalism', 2, None, '___sec46'),
              ('Particle-hole formalism', 2, None, '___sec47'),
              ('Particle-hole formalism', 2, None, '___sec48'),
              ('Particle-hole formalism', 2, None, '___sec49'),
              ('Particle-hole formalism', 2, None, '___sec50'),
              ('Particle-hole formalism', 2, None, '___sec51'),
              ('Particle-hole formalism', 2, None, '___sec52'),
              ('Summarizing and defining a normal-ordered Hamiltonian',
               2,
               None,
               '___sec53'),
              ('Summarizing and defining a normal-ordered Hamiltonian',
               2,
               None,
               '___sec54'),
              ('Summarizing and defining a normal-ordered Hamiltonian',
               2,
               None,
               '___sec55'),
              ('Summarizing and defining a normal-ordered Hamiltonian',
               2,
               None,
               '___sec56'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec57'),
              ("Hartree-Fock in second quantization and Thouless' theorem",
               2,
               None,
               '___sec58'),
              ("Thouless' theorem", 2, None, '___sec59'),
              ("Thouless' theorem", 2, None, '___sec60'),
              ('New operators', 2, None, '___sec61'),
              ("Showing that $|\\tilde{c}\\rangle= |c'\\rangle$",
               2,
               None,
               '___sec62'),
              ('Wrapping it up', 2, None, '___sec63'),
              ("Thouless' theorem", 2, None, '___sec64'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec65'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec66'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec67'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec68'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec69'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec70'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec71'),
              ('Hartree-Fock in second quantization and stability of HF solution',
               2,
               None,
               '___sec72'),
              ('Operators in second quantization', 2, None, '___sec73'),
              ('Operators in second quantization', 2, None, '___sec74'),
              ('Operators in second quantization', 2, None, '___sec75'),
              ('Operators in second quantization', 2, None, '___sec76'),
              ('Operators in second quantization', 2, None, '___sec77'),
              ('Operators in second quantization', 2, None, '___sec78'),
              ('Operators in second quantization', 2, None, '___sec79'),
              ('Operators in second quantization', 2, None, '___sec80'),
              ('Operators in second quantization', 2, None, '___sec81'),
              ('Exercises', 2, None, '___sec82'),
              ('Exercises', 2, None, '___sec83'),
              ('Exercises', 2, None, '___sec84'),
              ('Exercises', 2, None, '___sec85'),
              ('Exercises', 2, None, '___sec86'),
              ('Exercises', 2, None, '___sec87'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec88'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec89'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec90'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec91'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec92'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec93'),
              ('Exercises: Using sympy to compute matrix elements',
               2,
               None,
               '___sec94'),
              ('Exercises: Derivation of Hartree-Fock equations',
               2,
               None,
               '___sec95'),
              ('Exercises: Derivation of Hartree-Fock equations',
               2,
               None,
               '___sec96')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->

<!-- * TO DO: add material about Wick's theorem and diagrammatic representation -->

<p>


<center><h1>PHY 981 Nuclear Structure: Second Quantization</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen -->

<center>
<b>Morten Hjorth-Jensen</b> 
</center>

<p>
<!-- institution -->

<center><b><a href="http://www.nscl.msu.edu/" target="_blank">National Superconducting Cyclotron Laboratory</a> and <a href="https://www.pa.msu.edu/" target="_blank">Department of Physics and Astronomy</a>, <a href="http://www.msu.edu/" target="_blank">Michigan State University</a>, East Lansing, MI 48824, USA</b></center>
<br>
<p>
<center><h4>Spring 2016</h4></center> <!-- date -->
<br>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec0">Second quantization </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Second quantization.</b>
<p>

<ul>
<li> Second quantization and operators, two-body operator with examples</li> 
<li> Wick's theorem</li> 
<li> Thouless' theorem and analysis of the Hartree-Fock equations using second quantization</li>
<li> Examples on how to use bit representations for Slater determinants</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec1">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We introduce the time-independent  operators
\( a_\alpha^{\dagger} \) and \( a_\alpha \)   which create and annihilate, respectively, a particle 
in the single-particle state 
\( \varphi_\alpha \). 
We define the fermion creation operator
\( a_\alpha^{\dagger} \) 
$$
\begin{equation}
	a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle  \label{eq:2-1a},
\end{equation}
$$

and
$$
\begin{equation}
	a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-1b}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec2">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In Eq.&nbsp;\eqref{eq:2-1a} 
the operator  \( a_\alpha^{\dagger} \)  acts on the vacuum state 
\( |0\rangle \), which does not contain any particles. Alternatively, we could define  a closed-shell nucleus or atom as our new vacuum, but then
we need to introduce the particle-hole  formalism, see the discussion to come.

<p>
In Eq.&nbsp;\eqref{eq:2-1b} \( a_\alpha^{\dagger} \) acts on an antisymmetric \( n \)-particle state and 
creates an antisymmetric \( (n+1) \)-particle state, where the one-body state 
\( \varphi_\alpha \) is occupied, under the condition that
\( \alpha \ne \alpha_1, \alpha_2, \dots, \alpha_n \). 
It follows that we can express an antisymmetric state as the product of the creation
operators acting on the vacuum state.  
$$
\begin{equation}
	|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle \label{eq:2-2}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec3">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
It is easy to derive the commutation and anticommutation rules  for the fermionic creation operators 
\( a_\alpha^{\dagger} \). Using the antisymmetry of the states 
\eqref{eq:2-2}
$$
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_k\dots \alpha_n\rangle_{\mathrm{AS}} = 
		- |\alpha_1\dots \alpha_k\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} \label{eq:2-3a}
\end{equation}
$$

we obtain
$$
\begin{equation}
	 a_{\alpha_i}^{\dagger}  a_{\alpha_k}^{\dagger} = - a_{\alpha_k}^{\dagger} a_{\alpha_i}^{\dagger} \label{eq:2-3b}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec4">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Using the Pauli principle
$$
\begin{equation}
	|\alpha_1\dots \alpha_i\dots \alpha_i\dots \alpha_n\rangle_{\mathrm{AS}} = 0 \label{eq:2-4a}
\end{equation}
$$

it follows that
$$
\begin{equation}
	a_{\alpha_i}^{\dagger}  a_{\alpha_i}^{\dagger} = 0. \label{eq:2-4b}
\end{equation}
$$

If we combine Eqs.&nbsp;\eqref{eq:2-3b} and \eqref{eq:2-4b}, we obtain the well-known anti-commutation rule
$$
\begin{equation}
	a_{\alpha}^{\dagger}  a_{\beta}^{\dagger} + a_{\beta}^{\dagger}  a_{\alpha}^{\dagger} \equiv 
		\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = 0 \label{eq:2-5}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec5">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The hermitian conjugate  of \( a_\alpha^{\dagger} \) is
$$
\begin{equation}
	a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger} \label{eq:2-6}
\end{equation}
$$

If we take the hermitian conjugate of Eq.&nbsp;\eqref{eq:2-5}, we arrive at 
$$
\begin{equation}
	\{a_{\alpha},a_{\beta}\} = 0 \label{eq:2-7}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec6">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
What is the physical interpretation of the operator \( a_\alpha \) and what is the effect of 
\( a_\alpha \) on a given state \( |\alpha_1\alpha_2\dots\alpha_n\rangle_{\mathrm{AS}} \)? 
Consider the following matrix element
$$
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-8}
\end{equation}
$$

where both sides are antisymmetric. We  distinguish between two cases. The first (1) is when
\( \alpha \in \{\alpha_i\} \). Using the Pauli principle of Eq.&nbsp;\eqref{eq:2-4a} it follows
$$
\begin{equation}
		\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha = 0 \label{eq:2-9a}
\end{equation}
$$

The second (2) case is when \( \alpha \notin \{\alpha_i\} \). It follows that an hermitian conjugation
$$
\begin{equation}
		\langle \alpha_1\alpha_2 \dots \alpha_n|a_\alpha = \langle\alpha\alpha_1\alpha_2 \dots \alpha_n|  \label{eq:2-9b}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec7">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Eq.&nbsp;\eqref{eq:2-9b} holds for case (1) since the lefthand side is zero due to the Pauli principle. We write
Eq.&nbsp;\eqref{eq:2-8} as
$$
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_m'\rangle = 
	\langle \alpha_1\alpha_2 \dots \alpha_n|\alpha\alpha_1'\alpha_2' \dots \alpha_m'\rangle \label{eq:2-10}
\end{equation}
$$

Here we must have \( m = n+1 \) if Eq.&nbsp;\eqref{eq:2-10} has to be trivially different from zero.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec8">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
For the last case, the minus and plus signs apply when the sequence 
\( \alpha ,\alpha_1, \alpha_2, \dots, \alpha_n \) and 
\( \alpha_1', \alpha_2', \dots, \alpha_{n+1}' \) are related to each other via even and odd permutations.
If we assume that  \( \alpha \notin \{\alpha_i\} \) we obtain 
$$
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha_1'\alpha_2' \dots \alpha_{n+1}'\rangle = 0 \label{eq:2-12}
\end{equation}
$$

when \( \alpha \in \{\alpha_i'\} \). If \( \alpha \notin \{\alpha_i'\} \), we obtain
$$
\begin{equation}
	a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0 \label{eq:2-13a}
\end{equation}
$$

and in particular
$$
\begin{equation}
	a_\alpha |0\rangle = 0 \label{eq:2-13b}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec9">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If \( \{\alpha\alpha_i\} = \{\alpha_i'\} \), performing the right permutations, the sequence
\( \alpha ,\alpha_1, \alpha_2, \dots, \alpha_n \) is identical with the sequence
\( \alpha_1', \alpha_2', \dots, \alpha_{n+1}' \). This results in
$$
\begin{equation}
	\langle\alpha_1\alpha_2 \dots \alpha_n|a_\alpha|\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 1 \label{eq:2-14}
\end{equation}
$$

and thus
$$
\begin{equation}
	a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-15}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec10">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The action of the operator 
\( a_\alpha \) from the left on a state vector  is to to remove  one particle in the state
\( \alpha \). 
If the state vector does not contain the single-particle state \( \alpha \), the outcome of the operation is zero.
The operator  \( a_\alpha \) is normally called for a destruction or annihilation operator.

<p>
The next step is to establish the  commutator algebra of \( a_\alpha^{\dagger} \) and
\( a_\beta \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec11">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The action of the anti-commutator 
\( \{a_\alpha^{\dagger} \),$a_\alpha\}$ on a given \( n \)-particle state is
$$
\begin{align}
	a_\alpha^{\dagger} a_\alpha \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} &= 0 \nonumber \\
	a_\alpha a_\alpha^{\dagger} \underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} &=
	a_\alpha \underbrace{|\alpha \alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} = 
	\underbrace{|\alpha_1\alpha_2 \dots \alpha_{n}\rangle}_{\neq \alpha} \label{eq:2-16a}
\end{align}
$$

if the single-particle state \( \alpha \) is not contained in the state.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec12">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
 If it is present
we arrive at
$$
\begin{align}
	a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle &=
	a_\alpha^{\dagger} a_\alpha (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle \nonumber \\
	= (-1)^k |\alpha \alpha_1\alpha_2 \dots \alpha_{n-1}\rangle &=
	|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle \nonumber \\
	a_\alpha a_\alpha^{\dagger}|\alpha_1\alpha_2 \dots \alpha_{k}\alpha \alpha_{k+1} \dots \alpha_{n-1}\rangle &= 0 \label{eq:2-16b}
\end{align}
$$

From Eqs.&nbsp;\eqref{eq:2-16a} and  \eqref{eq:2-16b} we arrive at 
$$
\begin{equation}
	\{a_\alpha^{\dagger} , a_\alpha \} = a_\alpha^{\dagger} a_\alpha + a_\alpha a_\alpha^{\dagger} = 1 \label{eq:2-17}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec13">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The action of \( \left\{a_\alpha^{\dagger}, a_\beta\right\} \), with 
\( \alpha \ne \beta \) on a given state yields three possibilities. 
The first case is a state vector which contains both \( \alpha \) and \( \beta \), then either 
\( \alpha \) or \( \beta \) and finally none of them.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec14">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The first case results in
$$
\begin{eqnarray}
	a_\alpha^{\dagger} a_\beta |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \nonumber \\
	a_\beta a_\alpha^{\dagger} |\alpha\beta\alpha_1\alpha_2 \dots \alpha_{n-2}\rangle = 0 \label{eq:2-18a}
\end{eqnarray}
$$

while the second case gives
$$
\begin{eqnarray}
	 a_\alpha^{\dagger} a_\beta |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle &=& 
	 	|\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq  \alpha}\rangle \nonumber \\
	a_\beta a_\alpha^{\dagger} |\beta \underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle &=&
		a_\beta |\alpha\beta\underbrace{\beta \alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \nonumber \\
	&=& - |\alpha\underbrace{\alpha_1\alpha_2 \dots \alpha_{n-1}}_{\neq \alpha}\rangle \label{eq:2-18b}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec15">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Finally if the state vector does not contain \( \alpha \) and \( \beta \)
$$
\begin{eqnarray}
	a_\alpha^{\dagger} a_\beta |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle &=& 0 \nonumber \\
	a_\beta a_\alpha^{\dagger} |\underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle &=& 
		a_\beta |\alpha \underbrace{\alpha_1\alpha_2 \dots \alpha_{n}}_{\neq \alpha,\beta}\rangle = 0 \label{eq:2-18c}
\end{eqnarray}
$$

For all three cases we have
$$
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = a_\alpha^{\dagger} a_\beta + a_\beta a_\alpha^{\dagger} = 0, \quad \alpha \neq \beta \label{eq:2-19}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec16">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can summarize  our findings in Eqs.&nbsp;\eqref{eq:2-17} and \eqref{eq:2-19} as 
$$
\begin{equation}
	\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta} \label{eq:2-20}
\end{equation}
$$

with  \( \delta_{\alpha\beta} \) is the Kroenecker \( \delta \)-symbol.

<p>
The properties of the creation and annihilation operators can be summarized as (for fermions)
$$
	a_\alpha^{\dagger}|0\rangle \equiv  |\alpha\rangle,
$$

and
$$
	a_\alpha^{\dagger}|\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} \equiv  |\alpha\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}}. 
$$

from which follows
$$
        |\alpha_1\dots \alpha_n\rangle_{\mathrm{AS}} = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec17">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The hermitian conjugate has the folowing properties
$$
        a_{\alpha} = ( a_{\alpha}^{\dagger} )^{\dagger}.
$$

Finally we found 
$$
	a_\alpha\underbrace{|\alpha_1'\alpha_2' \dots \alpha_{n+1}'}\rangle_{\neq \alpha} = 0, \quad
		\textrm{in particular } a_\alpha |0\rangle = 0,
$$

and
$$
 a_\alpha |\alpha\alpha_1\alpha_2 \dots \alpha_{n}\rangle = |\alpha_1\alpha_2 \dots \alpha_{n}\rangle,
$$

and the corresponding commutator algebra
$$
	\{a_{\alpha}^{\dagger},a_{\beta}^{\dagger}\} = \{a_{\alpha},a_{\beta}\} = 0 \hspace{0.5cm} 
\{a_\alpha^{\dagger},a_\beta \} = \delta_{\alpha\beta}.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec18">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
A very useful operator is the so-called number-operator.  Most physics cases  we will
study in this text conserve the total number of particles.  The number operator is therefore
a useful quantity which allows us to test that our many-body formalism  conserves the number of particles.
In for example \( (d,p) \) or \( (p,d) \) reactions it is important to be able to describe quantum mechanical states
where particles get added or removed.
A creation operator \( a_\alpha^{\dagger} \) adds one particle to the single-particle state
\( \alpha \) of a give many-body state vector, while an annihilation operator \( a_\alpha \) 
removes a particle from a single-particle
state \( \alpha \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec19">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Let us consider an operator proportional with \( a_\alpha^{\dagger} a_\beta \) and 
\( \alpha=\beta \). It acts on an \( n \)-particle state 
resulting in
$$
\begin{equation}
	a_\alpha^{\dagger} a_\alpha |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	\begin{cases}
		0  &\alpha \notin \{\alpha_i\} \\
		\\
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle & \alpha \in \{\alpha_i\}
	\end{cases}
\label{_auto1}
\end{equation}
$$

Summing over all possible one-particle states we arrive at
$$
\begin{equation}
	\left( \sum_\alpha a_\alpha^{\dagger} a_\alpha \right) |\alpha_1\alpha_2 \dots \alpha_{n}\rangle = 
	n |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-21}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec20">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The operator 
$$
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^{\dagger} a_\alpha \label{eq:2-22}
\end{equation}
$$

is called the number operator since it counts the number of particles in a give state vector when it acts 
on the different single-particle states.  It acts on one single-particle state at the time and falls 
therefore under category one-body operators.
Next we look at another important one-body operator, namely \( \hat{H}_0 \) and study its operator form in the 
occupation number representation.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec21">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We want to obtain an expression for a one-body operator which conserves the number of particles.
Here we study the one-body operator for the kinetic energy plus an eventual external one-body potential.
The action of this operator on a particular \( n \)-body state with its pertinent expectation value has already
been studied in coordinate  space.
In coordinate space the operator reads
$$
\begin{equation}
	\hat{H}_0 = \sum_i \hat{h}_0(x_i) \label{eq:2-23}
\end{equation}
$$

and the anti-symmetric \( n \)-particle Slater determinant is defined as 
$$
\Phi(x_1, x_2,\dots ,x_n,\alpha_1,\alpha_2,\dots, \alpha_n)= \frac{1}{\sqrt{n!}} \sum_p (-1)^p\hat{P}\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n).
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec22">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Defining
$$
\begin{equation}
	\hat{h}_0(x_i) \psi_{\alpha_i}(x_i) = \sum_{\alpha_k'} \psi_{\alpha_k'}(x_i) \langle\alpha_k'|\hat{h}_0|\alpha_k\rangle \label{eq:2-25}
\end{equation}
$$

we can easily  evaluate the action of \( \hat{H}_0 \) on each product of one-particle functions in Slater determinant.
From Eq.&nbsp;\eqref{eq:2-25}  we obtain the following result without  permuting any particle pair 
$$
\begin{eqnarray}
	&& \left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	& =&\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle 
		\psi_{\alpha_1'}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	&+&\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2'}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	&+& \dots \nonumber \\
	&+&\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-26}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec23">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If we interchange particles \( 1 \) and \( 2 \)  we obtain
$$
\begin{eqnarray}
	&& \left( \sum_i \hat{h}_0(x_i) \right) \psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	& =&\sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle 
		\psi_{\alpha_1}(x_2)\psi_{\alpha_2'}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	&+&\sum_{\alpha_1'} \langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		\psi_{\alpha_1'}(x_2)\psi_{\alpha_2}(x_1) \dots \psi_{\alpha_n}(x_n) \nonumber \\
	&+& \dots \nonumber \\
	&+&\sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		\psi_{\alpha_1}(x_2)\psi_{\alpha_1}(x_2) \dots \psi_{\alpha_n'}(x_n) \label{eq:2-27}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec24">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can continue by computing all possible permutations. 
We rewrite also our Slater determinant in its second quantized form and skip the dependence on the quantum numbers \( x_i. \)
Summing up all contributions and taking care of all phases
\( (-1)^p \) we arrive at 
$$
\begin{eqnarray}
	\hat{H}_0|\alpha_1,\alpha_2,\dots, \alpha_n\rangle &=& \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		|\alpha_1'\alpha_2 \dots \alpha_{n}\rangle \nonumber \\
	&+& \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		|\alpha_1\alpha_2' \dots \alpha_{n}\rangle \nonumber \\
	&+& \dots \nonumber \\
	&+& \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		|\alpha_1\alpha_2 \dots \alpha_{n}'\rangle \label{eq:2-28}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec25">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In Eq.&nbsp;\eqref{eq:2-28} 
we have expressed the action of the one-body operator
of Eq.&nbsp;\eqref{eq:2-23} on the  \( n \)-body state in its second quantized form.
This equation can be further manipulated if we use the properties of the creation and annihilation operator
on each primed quantum number, that is
$$
\begin{equation}
	|\alpha_1\alpha_2 \dots \alpha_k' \dots \alpha_{n}\rangle = 
		a_{\alpha_k'}^{\dagger}  a_{\alpha_k} |\alpha_1\alpha_2 \dots \alpha_k \dots \alpha_{n}\rangle \label{eq:2-29}
\end{equation}
$$

Inserting this in the right-hand side of Eq.&nbsp;\eqref{eq:2-28} results in
$$
\begin{eqnarray}
	\hat{H}_0|\alpha_1\alpha_2 \dots \alpha_{n}\rangle &=& \sum_{\alpha_1'}\langle \alpha_1'|\hat{h}_0|\alpha_1\rangle
		a_{\alpha_1'}^{\dagger}  a_{\alpha_1} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber \\
	&+& \sum_{\alpha_2'} \langle \alpha_2'|\hat{h}_0|\alpha_2\rangle
		a_{\alpha_2'}^{\dagger}  a_{\alpha_2} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber \\
	&+& \dots \nonumber \\
	&+& \sum_{\alpha_n'} \langle \alpha_n'|\hat{h}_0|\alpha_n\rangle
		a_{\alpha_n'}^{\dagger}  a_{\alpha_n} |\alpha_1\alpha_2 \dots \alpha_{n}\rangle \nonumber \\
	&=& \sum_{\alpha, \beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta 
		|\alpha_1\alpha_2 \dots \alpha_{n}\rangle \label{eq:2-30a}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec26">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In the number occupation representation or second quantization we get the following expression for a one-body 
operator which conserves the number of particles
$$
\begin{equation}
	\hat{H}_0 = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle a_\alpha^{\dagger} a_\beta \label{eq:2-30b}
\end{equation}
$$

Obviously, \( \hat{H}_0 \) can be replaced by any other one-body  operator which preserved the number
of particles. The stucture of the operator is therefore not limited to say the kinetic or single-particle energy only.

<p>
The opearator \( \hat{H}_0 \) takes a particle from the single-particle state \( \beta \)  to the single-particle state \( \alpha \) 
with a probability for the transition given by the expectation value \( \langle \alpha|\hat{h}_0|\beta\rangle \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec27">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
It is instructive to verify Eq.&nbsp;\eqref{eq:2-30b} by computing the expectation value of \( \hat{H}_0 \) 
between two single-particle states
$$
\begin{equation}
	\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle
		\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle \label{eq:2-30c}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec28">Second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Using the commutation relations for the creation and annihilation operators we have 
$$
\begin{equation}
a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger} = (\delta_{\alpha \alpha_1} - a_\alpha^{\dagger} a_{\alpha_1} )(\delta_{\beta \alpha_2} - a_{\alpha_2}^{\dagger} a_{\beta} ), \label{eq:2-30d}
\end{equation}
$$

which results in
$$
\begin{equation}
\langle 0|a_{\alpha_1}a_\alpha^{\dagger} a_\beta a_{\alpha_2}^{\dagger}|0\rangle = \delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} \label{eq:2-30e}
\end{equation}
$$

and
$$
\begin{equation}
\langle \alpha_1|\hat{h}_0|\alpha_2\rangle = \sum_{\alpha\beta} \langle \alpha|\hat{h}_0|\beta\rangle\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} = \langle \alpha_1|\hat{h}_0|\alpha_2\rangle \label{eq:2-30f}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec29">Two-body operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Let us now derive the expression for our two-body interaction part, which also conserves the number of particles.
We can proceed in exactly the same way as for the one-body operator. In the coordinate representation our
two-body interaction part takes the following expression
$$
\begin{equation}
	\hat{H}_I = \sum_{i < j} V(x_i,x_j) \label{eq:2-31}
\end{equation}
$$

where the summation runs over distinct pairs. The term \( V \) can be an interaction model for the nucleon-nucleon interaction
or the interaction between two electrons. It can also include additional two-body interaction terms.

<p>
The action of this operator on a product of 
two single-particle functions is defined as 
$$
\begin{equation}
	V(x_i,x_j) \psi_{\alpha_k}(x_i) \psi_{\alpha_l}(x_j) = \sum_{\alpha_k'\alpha_l'} 
		\psi_{\alpha_k}'(x_i)\psi_{\alpha_l}'(x_j) 
		\langle \alpha_k'\alpha_l'|\hat{v}|\alpha_k\alpha_l\rangle \label{eq:2-32}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec30">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can now let \( \hat{H}_I \) act on all terms in the linear combination for \( |\alpha_1\alpha_2\dots\alpha_n\rangle \). Without any permutations we have
$$
\begin{eqnarray}
	&& \left( \sum_{i < j} V(x_i,x_j) \right) \psi_{\alpha_1}(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber \\
	&=& \sum_{\alpha_1'\alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}(x_n) \nonumber \\
	& +& \dots \nonumber \\
	&+& \sum_{\alpha_1'\alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		\psi_{\alpha_1}'(x_1)\psi_{\alpha_2}(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber \\
	& +& \dots \nonumber \\
	&+& \sum_{\alpha_2'\alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		\psi_{\alpha_1}(x_1)\psi_{\alpha_2}'(x_2)\dots \psi_{\alpha_n}'(x_n) \nonumber \\
	 & +& \dots \label{eq:2-33}
\end{eqnarray}
$$

where on the rhs we have a term for each distinct pairs.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec31">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
For the other terms on the rhs we obtain similar expressions  and summing over all terms we obtain
$$
\begin{eqnarray}
	H_I |\alpha_1\alpha_2\dots\alpha_n\rangle &=& \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		|\alpha_1'\alpha_2'\dots\alpha_n\rangle \nonumber \\
	&+& \dots \nonumber \\
	&+& \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		|\alpha_1'\alpha_2\dots\alpha_n'\rangle \nonumber \\
	&+& \dots \nonumber \\
	&+& \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		|\alpha_1\alpha_2'\dots\alpha_n'\rangle \nonumber \\
	 &+& \dots \label{eq:2-34}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec32">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We introduce second quantization via the relation
$$
\begin{eqnarray}
	&& a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k} 
		|\alpha_1\alpha_2\dots\alpha_k\dots\alpha_l\dots\alpha_n\rangle \nonumber \\
	&=& (-1)^{k-1} (-1)^{l-2} a_{\alpha_k'}^{\dagger} a_{\alpha_l'}^{\dagger} a_{\alpha_l} a_{\alpha_k}
		|\alpha_k\alpha_l \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k,\alpha_l}\rangle \nonumber \\
	&=& (-1)^{k-1} (-1)^{l-2} 
	|\alpha_k'\alpha_l' \underbrace{\alpha_1\alpha_2\dots\alpha_n}_{\neq \alpha_k',\alpha_l'}\rangle \nonumber \\
	&=& |\alpha_1\alpha_2\dots\alpha_k'\dots\alpha_l'\dots\alpha_n\rangle \label{eq:2-35}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec33">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Inserting this in \eqref{eq:2-34} gives
$$
\begin{eqnarray}
	H_I |\alpha_1\alpha_2\dots\alpha_n\rangle
	&=& \sum_{\alpha_1', \alpha_2'} \langle \alpha_1'\alpha_2'|\hat{v}|\alpha_1\alpha_2\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_2'}^{\dagger} a_{\alpha_2} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber \\
	&+& \dots \nonumber \\
	&=& \sum_{\alpha_1', \alpha_n'} \langle \alpha_1'\alpha_n'|\hat{v}|\alpha_1\alpha_n\rangle
		a_{\alpha_1'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_1}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber \\
	&+& \dots \nonumber \\
	&=& \sum_{\alpha_2', \alpha_n'} \langle \alpha_2'\alpha_n'|\hat{v}|\alpha_2\alpha_n\rangle
		a_{\alpha_2'}^{\dagger} a_{\alpha_n'}^{\dagger} a_{\alpha_n} a_{\alpha_2}
		|\alpha_1\alpha_2\dots\alpha_n\rangle \nonumber \\
	&+& \dots \nonumber \\
	&=& \sum_{\alpha, \beta, \gamma, \delta} ' \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma
		|\alpha_1\alpha_2\dots\alpha_n\rangle \label{eq:2-36}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec34">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Here we let \( \sum' \) indicate that the sums running over \( \alpha \) and \( \beta \) run over all
single-particle states, while the summations  \( \gamma \) and \( \delta \) 
run over all pairs of single-particle states. We wish to remove this restriction and since
$$
\begin{equation}
	\langle \alpha\beta|\hat{v}|\gamma\delta\rangle = \langle \beta\alpha|\hat{v}|\delta\gamma\rangle \label{eq:2-37}
\end{equation}
$$

we get
$$
\begin{eqnarray}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma &=& 
		\sum_{\alpha\beta} \langle \beta\alpha|\hat{v}|\delta\gamma\rangle 
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-38a} \\
	&=& \sum_{\alpha\beta}\langle \beta\alpha|\hat{v}|\delta\gamma\rangle
		a^{\dagger}_\beta a^{\dagger}_\alpha a_\gamma a_\delta \label{eq:2-38b}
\end{eqnarray}
$$

where we  have used the anti-commutation rules.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec35">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Changing the summation indices 
\( \alpha \) and \( \beta \) in \eqref{eq:2-38b} we obtain
$$
\begin{equation}
	\sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma =
		 \sum_{\alpha\beta} \langle \alpha\beta|\hat{v}|\delta\gamma\rangle 
		  a^{\dagger}_\alpha a^{\dagger}_\beta  a_\gamma a_\delta \label{eq:2-38c}
\end{equation}
$$

From this it follows that the restriction on the summation over \( \gamma \) and \( \delta \) can be removed if we multiply with a factor \( \frac{1}{2} \), resulting in 
$$
\begin{equation}
	\hat{H}_I = \frac{1}{2} \sum_{\alpha\beta\gamma\delta} \langle \alpha\beta|\hat{v}|\gamma\delta\rangle
		a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma \label{eq:2-39}
\end{equation}
$$

where we sum freely over all single-particle states \( \alpha \), 
\( \beta \), \( \gamma \) og \( \delta \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec36">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
With this expression we can now verify that the second quantization form of \( \hat{H}_I \) in Eq.&nbsp;\eqref{eq:2-39} 
results in the same matrix between two anti-symmetrized two-particle states as its corresponding coordinate
space representation. We have  
$$
\begin{equation}
	\langle \alpha_1 \alpha_2|\hat{H}_I|\beta_1 \beta_2\rangle =
		\frac{1}{2} \sum_{\alpha\beta\gamma\delta}
			\langle \alpha\beta|\hat{v}|\gamma\delta\rangle \langle 0|a_{\alpha_2} a_{\alpha_1} 
			 a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
			 a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle. \label{eq:2-40}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec37">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Using the commutation relations we get 
$$
\begin{eqnarray}
	&& a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		a_\delta a_\gamma a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		( a_\delta \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} - 
		a_\delta  a_{\beta_1}^{\dagger} a_\gamma a_{\beta_2}^{\dagger} ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta -
		a_\delta a_{\beta_1}^{\dagger}\delta_{\gamma \beta_2} +
		a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \nonumber \\
	&=& a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta 
		(\delta_{\gamma \beta_1} \delta_{\delta \beta_2} - \delta_{\gamma \beta_1} a_{\beta_2}^{\dagger} a_\delta \nonumber \\
		&& \qquad - \delta_{\delta \beta_1} \delta_{\gamma \beta_2} + \delta_{\gamma \beta_2} a_{\beta_1}^{\dagger} a_\delta
		+ a_\delta a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger} a_\gamma ) \label{eq:2-41}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec38">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The vacuum expectation value of this product of operators becomes
$$
\begin{eqnarray}
	&& \langle 0|a_{\alpha_2} a_{\alpha_1} a^{\dagger}_\alpha a^{\dagger}_\beta a_\delta a_\gamma 
		a_{\beta_1}^{\dagger} a_{\beta_2}^{\dagger}|0\rangle \nonumber \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -
		\delta_{\delta \beta_1} \delta_{\gamma \beta_2} ) 
		\langle 0|a_{\alpha_2} a_{\alpha_1}a^{\dagger}_\alpha a^{\dagger}_\beta|0\rangle \nonumber \\
	&=& (\delta_{\gamma \beta_1} \delta_{\delta \beta_2} -\delta_{\delta \beta_1} \delta_{\gamma \beta_2} )
	(\delta_{\alpha \alpha_1} \delta_{\beta \alpha_2} -\delta_{\beta \alpha_1} \delta_{\alpha \alpha_2} ) \label{eq:2-42b}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec39">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Insertion of 
Eq.&nbsp;\eqref{eq:2-42b} in Eq.&nbsp;\eqref{eq:2-40} results in
$$
\begin{eqnarray}
	\langle \alpha_1\alpha_2|\hat{H}_I|\beta_1\beta_2\rangle &=& \frac{1}{2} \big[ 
		\langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle- \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber \\
		&& - \langle \alpha_2\alpha_1|\hat{v}|\beta_1\beta_2\rangle + \langle \alpha_2\alpha_1|\hat{v}|\beta_2\beta_1\rangle \big] \nonumber \\
	&=& \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle - \langle \alpha_1\alpha_2|\hat{v}|\beta_2\beta_1\rangle \nonumber \\
	&=& \langle \alpha_1\alpha_2|\hat{v}|\beta_1\beta_2\rangle_{\mathrm{AS}}. \label{eq:2-43b}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec40">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The two-body operator can also be expressed in terms of the anti-symmetrized matrix elements we discussed previously as
$$
\begin{eqnarray}
	\hat{H}_I &=& \frac{1}{2} \sum_{\alpha\beta\gamma\delta}  \langle \alpha \beta|\hat{v}|\gamma \delta\rangle
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \left[ \langle \alpha \beta|\hat{v}|\gamma \delta\rangle -
		\langle \alpha \beta|\hat{v}|\delta\gamma \rangle \right] 
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \nonumber \\
	&=& \frac{1}{4} \sum_{\alpha\beta\gamma\delta} \langle \alpha \beta|\hat{v}|\gamma \delta\rangle_{\mathrm{AS}}
		a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma \label{eq:2-45}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec41">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The factors in front of the operator, either  \( \frac{1}{4} \) or 
\( \frac{1}{2} \) tells whether we use antisymmetrized matrix elements or not.

<p>
We can now express the Hamiltonian operator for a many-fermion system  in the occupation basis representation
as  
$$
\begin{equation}
	H = \sum_{\alpha, \beta} \langle \alpha|\hat{t}+\hat{u}_{\mathrm{ext}}|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
		\langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma. \label{eq:2-46b}
\end{equation}
$$

This is the form we will use in the rest of these lectures, assuming that we work with anti-symmetrized two-body matrix elements.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec42">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Second quantization is a useful and elegant formalism  for constructing many-body  states and 
quantum mechanical operators. One can express and translate many physical processes
into simple pictures such as Feynman diagrams. Expecation values of many-body states are also easily calculated.
However, although the equations are seemingly easy to set up, from  a practical point of view, that is
the solution of Schroedinger's equation, there is no particular gain.
The many-body equation is equally hard to solve, irrespective of representation. 
The cliche that 
there is no free lunch brings us down to earth again.  
Note however that a transformation to a particular
basis, for cases where the interaction obeys specific symmetries, can ease the solution of Schroedinger's equation.

<p>
But there is at least one important case where second quantization comes to our rescue.
It is namely easy to introduce another reference state than the pure vacuum \( |0\rangle  \), where all single-particle states are active.
With many particles present it is often useful to introduce another reference state  than the vacuum state$|0\rangle $. We will label this state \( |c\rangle \) (\( c \) for core) and as we will see it can reduce 
considerably the complexity and thereby the dimensionality of the many-body problem. It allows us to sum up to infinite order specific many-body correlations.  The particle-hole representation is one of these handy representations.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec43">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In the original particle representation these states are products of the creation operators  \( a_{\alpha_i}^\dagger \) acting on the true vacuum \( |0\rangle  \).
Following Eq.&nbsp;\eqref{eq:2-2} we have 
$$
\begin{eqnarray}
 |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle &=& a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
					a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-47a} \\
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle &=&
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger
		a_{\alpha_{n+1}}^\dagger |0\rangle  \label{eq:2-47b} \\
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle &=& a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots
		a_{\alpha_{n-1}}^\dagger |0\rangle  \label{eq:2-47c}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec44">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If we use Eq.&nbsp;\eqref{eq:2-47a} as our new reference state, we can simplify considerably the representation of 
this state
$$
\begin{equation}
	|c\rangle  \equiv |\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\rangle =
		a_{\alpha_1}^\dagger a_{\alpha_2}^\dagger \dots a_{\alpha_{n-1}}^\dagger a_{\alpha_n}^\dagger |0\rangle  \label{eq:2-48a}
\end{equation}
$$

The new reference states for the \( n+1 \) and \( n-1 \) states can then be written as
$$
\begin{eqnarray}
	|\alpha_1\alpha_2\dots\alpha_{n-1}\alpha_n\alpha_{n+1}\rangle &=& (-1)^n a_{\alpha_{n+1}}^\dagger |c\rangle 
		\equiv (-1)^n |\alpha_{n+1}\rangle_c \label{eq:2-48b} \\
	|\alpha_1\alpha_2\dots\alpha_{n-1}\rangle &=& (-1)^{n-1} a_{\alpha_n} |c\rangle  
		\equiv (-1)^{n-1} |\alpha_{n-1}\rangle_c \label{eq:2-48c} 
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec45">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The first state has one additional particle with respect to the new vacuum state
\( |c\rangle  \)  and is normally referred to as a one-particle state or one particle added to the 
many-body reference state. 
The second state has one particle less than the reference vacuum state  \( |c\rangle  \) and is referred to as
a one-hole state. 
When dealing with a new reference state it is often convenient to introduce 
new creation and annihilation operators since we have 
from Eq.&nbsp;\eqref{eq:2-48c}
$$
\begin{equation}
	a_\alpha |c\rangle  \neq 0 \label{eq:2-49}
\end{equation}
$$

since  \( \alpha \) is contained  in \( |c\rangle  \), while for the true vacuum we have 
\( a_\alpha |0\rangle  = 0 \) for all \( \alpha \).

<p>
The new reference state leads to the definition of new creation and annihilation operators
which satisfy the following relations
$$
\begin{eqnarray}
	b_\alpha |c\rangle  &=& 0 \label{eq:2-50a} \\
	\{b_\alpha^\dagger , b_\beta^\dagger \} = \{b_\alpha , b_\beta \} &=& 0 \nonumber  \\
	\{b_\alpha^\dagger , b_\beta \} &=& \delta_{\alpha \beta} \label{eq:2-50c}
\end{eqnarray}
$$

We assume also that the new reference state is properly normalized
$$
\begin{equation}
	\langle c | c \rangle = 1 \label{eq:2-51}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec46">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The physical interpretation of these new operators is that of so-called quasiparticle states.
This means that a state defined by the addition of one extra particle to a reference state \( |c\rangle  \) may not necesseraly be interpreted as one particle coupled to a core.
We define now new creation operators that act on a state \( \alpha \) creating a new quasiparticle state
$$
\begin{equation}
	b_\alpha^\dagger|c\rangle  = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger |c\rangle  = |\alpha\rangle, & \alpha > F \\
		\\
		a_\alpha |c\rangle  = |\alpha^{-1}\rangle, & \alpha \leq F
	\end{array} \label{eq:2-52}
\end{equation}
$$

where \( F \) is the Fermi level representing the last  occupied single-particle orbit 
of the new reference state \( |c\rangle  \).

<p>
The annihilation is the hermitian conjugate of the creation operator
$$
	b_\alpha = (b_\alpha^\dagger)^\dagger,
$$

resulting in
$$
\begin{equation}
	b_\alpha^\dagger = \Bigg\{ \begin{array}{ll}
		a_\alpha^\dagger & \alpha > F \\
		\\
		a_\alpha & \alpha \leq F
	\end{array} \qquad 
	b_\alpha = \Bigg\{ \begin{array}{ll}
		a_\alpha & \alpha > F \\
		\\
		 a_\alpha^\dagger & \alpha \leq F
	\end{array} \label{eq:2-54}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec47">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
With the new creation and annihilation operator  we can now construct 
many-body quasiparticle states, with one-particle-one-hole states, two-particle-two-hole
states etc in the same fashion as we previously constructed many-particle states. 
We can write a general particle-hole state as
$$
\begin{equation}
	|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \equiv
		\underbrace{b_{\beta_1}^\dagger b_{\beta_2}^\dagger \dots b_{\beta_{n_p}}^\dagger}_{>F}
		\underbrace{b_{\gamma_1}^\dagger b_{\gamma_2}^\dagger \dots b_{\gamma_{n_h}}^\dagger}_{\leq F} |c\rangle \label{eq:2-56}
\end{equation}
$$

We can now rewrite our one-body and two-body operators in terms of the new creation and annihilation operators.
The number operator becomes
$$
\begin{equation}
	\hat{N} = \sum_\alpha a_\alpha^\dagger a_\alpha= 
\sum_{\alpha > F} b_\alpha^\dagger b_\alpha + n_c - \sum_{\alpha \leq F} b_\alpha^\dagger b_\alpha \label{eq:2-57b}
\end{equation}
$$

where \( n_c \) is the number of particle in the new vacuum state \( |c\rangle  \).  
The action of \( \hat{N} \) on a many-body state results in 
$$
\begin{equation}
	N |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle = (n_p + n_c - n_h) |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{2-59}
\end{equation}
$$

Here  \( n=n_p +n_c - n_h \) is the total number of particles in the quasi-particle state of 
Eq.&nbsp;\eqref{eq:2-56}. Note that  \( \hat{N} \) counts the total number of particles  present 
$$
\begin{equation}
	N_{qp} = \sum_\alpha b_\alpha^\dagger b_\alpha, \label{eq:2-60}
\end{equation}
$$

gives us the number of quasi-particles as can be seen by computing
$$
\begin{equation}
	N_{qp}= |\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle
		= (n_p + n_h)|\beta_1\beta_2\dots \beta_{n_p} \gamma_1^{-1} \gamma_2^{-1} \dots \gamma_{n_h}^{-1}\rangle \label{eq:2-61}
\end{equation}
$$

where \( n_{qp} = n_p + n_h \) is the total number of quasi-particles.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec48">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We express the one-body operator \( \hat{H}_0 \) in terms of the quasi-particle creation and annihilation operators, resulting in
$$
\begin{eqnarray}
	\hat{H}_0 &=& \sum_{\alpha\beta > F} \langle \alpha|\hat{h}_0|\beta\rangle  b_\alpha^\dagger b_\beta +
		\sum_{\begin{array}{c} \alpha > F \\ \beta \leq F \end{array}} \left[
		\langle \alpha|\hat{h}_0|\beta\rangle b_\alpha^\dagger b_\beta^\dagger + 
		\langle \beta|\hat{h}_0|\alpha\rangle b_\beta  b_\alpha \right] \nonumber \\
	&+& \sum_{\alpha \leq F} \langle \alpha|\hat{h}_0|\alpha\rangle - 
		\sum_{\alpha\beta \leq F} \langle \beta|\hat{h}_0|\alpha\rangle
		b_\alpha^\dagger b_\beta \label{eq:2-63b}
\end{eqnarray}
$$

The first term  gives contribution only for particle states, while the last one
contributes only for holestates. The second term can create or destroy a set of
quasi-particles and 
the third term is the contribution  from the vacuum state \( |c\rangle \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec49">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Before we continue with the expressions for the two-body operator, we introduce a nomenclature we will use for the rest of this
text. It is inspired by the notation used in quantum chemistry.
We reserve the labels \( i,j,k,\dots \) for hole states and \( a,b,c,\dots \) for states above \( F \), viz.&nbsp;particle states.
This means also that we will skip the constraint \( \leq F \) or \( > F \) in the summation symbols. 
Our operator \( \hat{H}_0 \)  reads now 
$$
\begin{eqnarray}
	\hat{H}_0 &=& \sum_{ab} \langle a|\hat{h}|b\rangle b_a^\dagger b_b +
		\sum_{ai} \left[
		\langle a|\hat{h}|i\rangle b_a^\dagger b_i^\dagger + 
		\langle i|\hat{h}|a\rangle b_i  b_a \right] \nonumber \\
	&+& \sum_{i} \langle i|\hat{h}|i\rangle - 
		\sum_{ij} \langle j|\hat{h}|i\rangle
		b_i^\dagger b_j \label{eq:2-63c}
\end{eqnarray} 
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec50">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The two-particle operator in the particle-hole formalism  is more complicated since we have
to translate four indices \( \alpha\beta\gamma\delta \) to the possible combinations of particle and hole
states.  When performing the commutator algebra we can regroup the operator in five different terms
$$
\begin{equation}
	\hat{H}_I = \hat{H}_I^{(a)} + \hat{H}_I^{(b)} + \hat{H}_I^{(c)} + \hat{H}_I^{(d)} + \hat{H}_I^{(e)} \label{eq:2-65}
\end{equation}
$$

Using anti-symmetrized  matrix elements, 
bthe term  \( \hat{H}_I^{(a)} \) is  
$$
\begin{equation}
	\hat{H}_I^{(a)} = \frac{1}{4}
	\sum_{abcd} \langle ab|\hat{V}|cd\rangle 
		b_a^\dagger b_b^\dagger b_d b_c \label{eq:2-66}
\end{equation}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec51">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The next term \( \hat{H}_I^{(b)} \)  reads
$$
\begin{equation}
	 \hat{H}_I^{(b)} = \frac{1}{4} \sum_{abci}\left(\langle ab|\hat{V}|ci\rangle b_a^\dagger b_b^\dagger b_i^\dagger b_c +\langle ai|\hat{V}|cb\rangle b_a^\dagger b_i b_b b_c\right) \label{eq:2-67b}
\end{equation}
$$

This term conserves the number of quasiparticles but creates or removes a 
three-particle-one-hole  state. 
For \( \hat{H}_I^{(c)} \)  we have
$$
\begin{eqnarray}
	\hat{H}_I^{(c)}& =& \frac{1}{4}
		\sum_{abij}\left(\langle ab|\hat{V}|ij\rangle b_a^\dagger b_b^\dagger b_j^\dagger b_i^\dagger +
		\langle ij|\hat{V}|ab\rangle b_a  b_b b_j b_i \right)+  \nonumber \\
	&&	\frac{1}{2}\sum_{abij}\langle ai|\hat{V}|bj\rangle b_a^\dagger b_j^\dagger b_b b_i + 
		\frac{1}{2}\sum_{abi}\langle ai|\hat{V}|bi\rangle b_a^\dagger b_b. \label{eq:2-68c}
\end{eqnarray}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec52">Particle-hole formalism </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The first line stands for the creation of a two-particle-two-hole state, while the second line represents
the creation to two one-particle-one-hole pairs
while the last term represents a contribution to the particle single-particle energy
from the hole states, that is an interaction between the particle states and the hole states
within the new vacuum  state.
The fourth term reads
$$
\begin{eqnarray}
	 \hat{H}_I^{(d)}& = &\frac{1}{4} 
	 	\sum_{aijk}\left(\langle ai|\hat{V}|jk\rangle b_a^\dagger b_k^\dagger b_j^\dagger b_i+
\langle ji|\hat{V}|ak\rangle b_k^\dagger b_j b_i b_a\right)+\nonumber \\
&&\frac{1}{4}\sum_{aij}\left(\langle ai|\hat{V}|ji\rangle b_a^\dagger b_j^\dagger+
\langle ji|\hat{V}|ai\rangle - \langle ji|\hat{V}|ia\rangle b_j b_a \right). \label{eq:2-69d} 
\end{eqnarray}
$$

The terms in the first line  stand for the creation of a particle-hole state 
interacting with hole states, we will label this as a two-hole-one-particle contribution. 
The remaining terms are a particle-hole state interacting with the holes in the vacuum state. 
Finally we have 
$$
\begin{equation}
	\hat{H}_I^{(e)} = \frac{1}{4}
		 \sum_{ijkl}
		 \langle kl|\hat{V}|ij\rangle b_i^\dagger b_j^\dagger b_l b_k+
	        \frac{1}{2}\sum_{ijk}\langle ij|\hat{V}|kj\rangle b_k^\dagger b_i
	        +\frac{1}{2}\sum_{ij}\langle ij|\hat{V}|ij\rangle \label{eq:2-70d}
\end{equation}
$$

The first terms represents the 
interaction between two holes while the second stands for the interaction between a hole and the remaining holes in the vacuum state.
It represents a contribution to single-hole energy  to first order.
The last term collects all contributions to the energy of the ground state of a closed-shell system arising
from hole-hole correlations.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec53">Summarizing and defining a normal-ordered Hamiltonian </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
$$
  \Phi_{AS}(\alpha_1, \dots, \alpha_A; x_1, \dots x_A)=
            \frac{1}{\sqrt{A}} \sum_{\hat{P}} (-1)^P \hat{P} \prod_{i=1}^A \psi_{\alpha_i}(x_i),
$$

which is equivalent with \( |\alpha_1 \dots \alpha_A\rangle= a_{\alpha_1}^{\dagger} \dots a_{\alpha_A}^{\dagger} |0\rangle \). We have also
$$
        a_p^\dagger|0\rangle = |p\rangle, \quad a_p |q\rangle = \delta_{pq}|0\rangle
    $$

$$
  \delta_{pq} = \left\{a_p, a_q^\dagger \right\},
$$

and 
$$
0 = \left\{a_p^\dagger, a_q \right\} = \left\{a_p, a_q \right\} = \left\{a_p^\dagger, a_q^\dagger \right\}
$$

$$
|\Phi_0\rangle = |\alpha_1 \dots \alpha_A\rangle, \quad \alpha_1, \dots, \alpha_A \leq \alpha_F
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec54">Summarizing and defining a normal-ordered Hamiltonian </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
$$
\left\{a_p^\dagger, a_q \right\}= \delta_{pq}, p, q \leq \alpha_F 
$$

$$
\left\{a_p, a_q^\dagger \right\} = \delta_{pq}, p, q > \alpha_F
$$

with         \( i,j,\ldots \leq \alpha_F, \quad a,b,\ldots > \alpha_F, \quad p,q, \ldots - \textrm{any} \)
$$
        a_i|\Phi_0\rangle = |\Phi_i\rangle, \hspace{0.5cm} a_a^\dagger|\Phi_0\rangle = |\Phi^a\rangle
$$

and         
$$
a_i^\dagger|\Phi_0\rangle = 0 \hspace{0.5cm}  a_a|\Phi_0\rangle = 0
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec55">Summarizing and defining a normal-ordered Hamiltonian </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>One- and two-body operators.</b>
<p>
The one-body operator is defined as
$$
 \hat{F} = \sum_{pq} \langle p|\hat{f}|q\rangle a_p^\dagger a_q
$$

while the two-body opreator is defined as
$$
\hat{V} = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle_{AS} a_p^\dagger a_q^\dagger a_s a_r
$$

where we have defined the antisymmetric matrix elements
$$
\langle pq|\hat{v}|rs\rangle_{AS} = \langle pq|\hat{v}|rs\rangle - \langle pq|\hat{v}|sr\rangle.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec56">Summarizing and defining a normal-ordered Hamiltonian </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can also define a three-body operator
$$
\hat{V}_3 = \frac{1}{36} \sum_{pqrstu} \langle pqr|\hat{v}_3|stu\rangle_{AS} 
                a_p^\dagger a_q^\dagger a_r^\dagger a_u a_t a_s
$$

with the antisymmetrized matrix element
$$
\begin{align}
            \langle pqr|\hat{v}_3|stu\rangle_{AS} = \langle pqr|\hat{v}_3|stu\rangle + \langle pqr|\hat{v}_3|tus\rangle + \langle pqr|\hat{v}_3|ust\rangle- \langle pqr|\hat{v}_3|sut\rangle - \langle pqr|\hat{v}_3|tsu\rangle - \langle pqr|\hat{v}_3|uts\rangle.
\label{_auto2}
\end{align}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec57">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We wish now to derive the Hartree-Fock equations using our second-quantized formalism and study the stability of the equations. 
Our ansatz for the ground state of the system is approximated as (this is our representation of a Slater determinant in second quantization)
$$   
|\Phi_0\rangle = |c\rangle = a^{\dagger}_i a^{\dagger}_j \dots a^{\dagger}_l|0\rangle.
$$

We wish to determine \( \hat{u}^{HF} \) so that 
\( E_0^{HF}= \langle c|\hat{H}| c\rangle \) becomes a local minimum.

<p>
In our analysis here we will need Thouless' theorem, which states that
an arbitrary Slater determinant \( |c'\rangle \) which is not orthogonal to a determinant
\( | c\rangle ={\displaystyle\prod_{i=1}^{n}}
a_{\alpha_{i}}^{\dagger}|0\rangle \), can be written as
$$
|c'\rangle=exp\left\{\sum_{a>F}\sum_{i\le F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle 
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec58">Hartree-Fock in second quantization and Thouless' theorem </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
Let us give a simple proof of Thouless' theorem. The theorem states that we can make a linear combination av particle-hole excitations  with respect to a given reference state \( \vert c\rangle \). With this linear combination, we can make a new Slater determinant \( \vert c'\rangle  \) which is not orthogonal to 
\( \vert c\rangle \), that is
$$
\langle c|c'\rangle \ne 0.
$$

To show this we need some intermediate steps. The exponential product of two operators  \( \exp{\hat{A}}\times\exp{\hat{B}} \) is equal to \( \exp{(\hat{A}+\hat{B})} \) only if the two operators commute, that is
$$
[\hat{A},\hat{B}] = 0.
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec59">Thouless' theorem </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
If the operators do not commute, we need to resort to the <a href="http://www.encyclopediaofmath.org/index.php/Campbell%E2%80%93Hausdorff_formula" target="_blank">Baker-Campbell-Hauersdorf</a>. This relation states that
$$
\exp{\hat{C}}=\exp{\hat{A}}\exp{\hat{B}},
$$

with 
$$
\hat{C}=\hat{A}+\hat{B}+\frac{1}{2}[\hat{A},\hat{B}]+\frac{1}{12}[[\hat{A},\hat{B}],\hat{B}]-\frac{1}{12}[[\hat{A},\hat{B}],\hat{A}]+\dots
$$

From these relations, we note that 
in our expression  for \( |c'\rangle \) we have commutators of the type
$$
[a_{a}^{\dagger}a_{i},a_{b}^{\dagger}a_{j}],
$$

and it is easy to convince oneself that these commutators, or higher powers thereof, are all zero. This means that we can write out our new representation of a Slater determinant as
$$
|c'\rangle=exp\left\{\sum_{a>F}\sum_{i\le F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}+\left(\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right)^2+\dots\right\}| c\rangle
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec60">Thouless' theorem </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
We note that
$$
\prod_{i}\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\sum_{b>F}C_{bi}a_{b}^{\dagger}a_{i}| c\rangle =0,
$$

and all higher-order powers of these combinations of creation and annihilation operators disappear 
due to the fact that \( (a_i)^n| c\rangle =0 \) when \( n > 1 \). This allows us to rewrite the expression for \( |c'\rangle  \) as
$$
|c'\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle,
$$

which we can rewrite as 
$$
|c'\rangle=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| a^{\dagger}_{i_1} a^{\dagger}_{i_2} \dots a^{\dagger}_{i_n}|0\rangle.
$$

The last equation can be written as
$$
\begin{align}
|c'\rangle&=\prod_{i}\left\{1+\sum_{a>F}C_{ai}a_{a}^{\dagger}a_{i}\right\}| a^{\dagger}_{i_1} a^{\dagger}_{i_2} \dots a^{\dagger}_{i_n}|0\rangle=\left(1+\sum_{a>F}C_{ai_1}a_{a}^{\dagger}a_{i_1}\right)a^{\dagger}_{i_1} 
\label{_auto3}\\
& \times\left(1+\sum_{a>F}C_{ai_2}a_{a}^{\dagger}a_{i_2}\right)a^{\dagger}_{i_2} \dots |0\rangle=\prod_{i}\left(a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}\right)|0\rangle.
\label{_auto4}
\end{align}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec61">New operators </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
If we define a new creation operator 
$$
\begin{equation}
b^{\dagger}_{i}=a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}, \label{eq:newb}
\end{equation}
$$

we have 
$$
|c'\rangle=\prod_{i}b^{\dagger}_{i}|0\rangle=\prod_{i}\left(a^{\dagger}_{i}+\sum_{a>F}C_{ai}a_{a}^{\dagger}\right)|0\rangle,
$$

meaning that the new representation of the Slater determinant in second quantization, \( |c'\rangle \), looks like our previous ones. However, this representation is not general enough since we have a restriction on the sum over single-particle states in Eq.&nbsp;\eqref{eq:newb}. The single-particle states have all to be above the Fermi level.
The question then is whether we can construct a general representation of a Slater determinant with a creation operator 
$$
\tilde{b}^{\dagger}_{i}=\sum_{p}f_{ip}a_{p}^{\dagger},
$$

where \( f_{ip} \) is a matrix element of a unitary matrix which transforms our creation and annihilation operators
\( a^{\dagger} \) and \( a \) to \( \tilde{b}^{\dagger} \) and \( \tilde{b} \). These new operators define a new representation of a Slater determinant as
$$
|\tilde{c}\rangle=\prod_{i}\tilde{b}^{\dagger}_{i}|0\rangle.
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec62">Showing that \( |\tilde{c}\rangle= |c'\rangle \)  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
We need to show that \( |\tilde{c}\rangle= |c'\rangle \). We need also to assume that the new state
is not orthogonal to \( |c\rangle \), that is \( \langle c| \tilde{c}\rangle \ne 0 \). From this it follows that 
$$
\langle c| \tilde{c}\rangle=\langle 0| a_{i_n}\dots a_{i_1}\left(\sum_{p=i_1}^{i_n}f_{i_1p}a_{p}^{\dagger} \right)\left(\sum_{q=i_1}^{i_n}f_{i_2q}a_{q}^{\dagger} \right)\dots \left(\sum_{t=i_1}^{i_n}f_{i_nt}a_{t}^{\dagger} \right)|0\rangle,
$$

which is nothing but the determinant \( det(f_{ip}) \) which we can, using the intermediate normalization condition, 
normalize to one, that is
$$
det(f_{ip})=1,
$$

meaning that \( f \) has an inverse defined as (since we are dealing with orthogonal, and in our case unitary as well, transformations)
$$
\sum_{k} f_{ik}f^{-1}_{kj} = \delta_{ij},
$$

and 
$$
\sum_{j} f^{-1}_{ij}f_{jk} = \delta_{ik}.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec63">Wrapping it up  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
Using these relations we can then define the linear combination of creation (and annihilation as well) 
operators as
$$
\sum_{i}f^{-1}_{ki}\tilde{b}^{\dagger}_{i}=\sum_{i}f^{-1}_{ki}\sum_{p=i_1}^{\infty}f_{ip}a_{p}^{\dagger}=a_{k}^{\dagger}+\sum_{i}\sum_{p=i_{n+1}}^{\infty}f^{-1}_{ki}f_{ip}a_{p}^{\dagger}.
$$

Defining 
$$
c_{kp}=\sum_{i \le F}f^{-1}_{ki}f_{ip},
$$

we can redefine 
$$
a_{k}^{\dagger}+\sum_{i}\sum_{p=i_{n+1}}^{\infty}f^{-1}_{ki}f_{ip}a_{p}^{\dagger}=a_{k}^{\dagger}+\sum_{p=i_{n+1}}^{\infty}c_{kp}a_{p}^{\dagger}=b_k^{\dagger},
$$

our starting point. We have shown that our general representation of a Slater determinant 
$$
|\tilde{c}\rangle=\prod_{i}\tilde{b}^{\dagger}_{i}|0\rangle=|c'\rangle=\prod_{i}b^{\dagger}_{i}|0\rangle,
$$

with 
$$
b_k^{\dagger}=a_{k}^{\dagger}+\sum_{p=i_{n+1}}^{\infty}c_{kp}a_{p}^{\dagger}.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec64">Thouless' theorem   </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
This means that we can actually write an ansatz for the ground state of the system as a linear combination of
terms which contain the ansatz itself \( |c\rangle \) with  an admixture from an infinity of one-particle-one-hole states. The latter has important consequences when we wish to interpret the Hartree-Fock equations and their stability. We can rewrite the new representation as 
$$
|c'\rangle = |c\rangle+|\delta c\rangle,
$$

where \( |\delta c\rangle \) can now be interpreted as a small variation. If we approximate this term with 
contributions from one-particle-one-hole (<em>1p-1h</em>) states only, we arrive at 
$$
|c'\rangle = \left(1+\sum_{ai}\delta C_{ai}a_{a}^{\dagger}a_i\right)|c\rangle.
$$

In our derivation of the Hartree-Fock equations we have shown that 
$$
\langle \delta c| \hat{H} | c\rangle =0,
$$

which means that we have to satisfy
$$
\langle c|\sum_{ai}\delta C_{ai}\left\{a_{a}^{\dagger}a_i\right\} \hat{H} | c\rangle =0.
$$

With this as a background, we are now ready to study the stability of the Hartree-Fock equations.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec65">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The variational condition for deriving the Hartree-Fock equations guarantees only that the expectation value \( \langle c | \hat{H} | c \rangle \) has an extreme value, not necessarily a minimum. To figure out whether the extreme value we have found  is a minimum, we can use second quantization to analyze our results and find a criterion 
for the above expectation value to a local minimum. We will use Thouless' theorem and show that
$$
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} \ge \langle c |\hat{H} | c\rangle= E_0,
$$

with
$$
 {|c'\rangle} = {|c\rangle + |\delta c\rangle}.
$$

Using Thouless' theorem we can write out \( {|c'\rangle} \) as
$$
\begin{align}
 {|c'\rangle}&=\exp\left\{\sum_{a > F}\sum_{i \le F}\delta C_{ai}a_{a}^{\dagger}a_{i}\right\}| c\rangle
\label{_auto5}\\ 
&=\left\{1+\sum_{a > F}\sum_{i \le F}\delta C_{ai}a_{a}^{\dagger}
a_{i}+\frac{1}{2!}\sum_{ab > F}\sum_{ij \le F}\delta C_{ai}\delta C_{bj}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}+\dots\right\}
\label{_auto6}
\end{align}
$$

where the amplitudes \( \delta C \) are small.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec66">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
The norm of \( |c'\rangle \) is given by (using the intermediate normalization condition \( \langle c' |c\rangle=1 \)) 
$$
\langle c' | c'\rangle = 1+\sum_{a>F}
\sum_{i\le F}|\delta C_{ai}|^2+O(\delta C_{ai}^3).
$$

The expectation value for the energy is now given by (using the Hartree-Fock condition)
$$
\langle c' |\hat{H} | c'\rangle=\langle c |\hat{H} | c\rangle +
\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}\langle c |a_{i}^{\dagger}a_{a}\hat{H}a_{b}^{\dagger}a_{j}|c\rangle+
$$

$$
\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}\delta C_{bj}\langle c |\hat{H}a_{a}^{\dagger}a_{i}a_{b}^{\dagger}a_{j}|c\rangle+\frac{1}{2!}\sum_{ab>F}
\sum_{ij\le F}\delta C_{ai}^*\delta C_{bj}^*\langle c|a_{j}^{\dagger}a_{b}a_{i}^{\dagger}a_{a}\hat{H}|c\rangle
+\dots
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec67">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We have already calculated the second term on the right-hand side of the previous equation
$$
\begin{align}
\langle c | \left(\{a^\dagger_i a_a\} \hat{H} \{a^\dagger_b a_j\} \right) | c\rangle&=\sum_{pq} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \langle p|\hat{h}_0 |q\rangle 
            \langle c | \left(\{a^{\dagger}_i a_a\}\{a^{\dagger}_pa_q\} 
             \{a^{\dagger}_b a_j\} \right)| c\rangle
\label{_auto7}\\
& +\frac{1}{4} \sum_{pqrs} \sum_{ijab}\delta C_{ai}^*\delta C_{bj} \langle pq| \hat{v}|rs\rangle 
            \langle c | \left(\{a^\dagger_i a_a\}\{a^{\dagger}_p a^{\dagger}_q a_s  a_r\} \{a^{\dagger}_b a_j\} \right)| c\rangle ,
\label{_auto8}
\end{align}
$$

resulting in
$$
E_0\sum_{ai}|\delta C_{ai}|^2+\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a-\varepsilon_i)-\sum_{ijab} \langle aj|\hat{v}| bi\rangle \delta C_{ai}^*\delta C_{bj}.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec68">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
$$
\frac{1}{2!}\langle c |\left(\{a^\dagger_j a_b\} \{a^\dagger_i a_a\} \hat{V}_N  \right) | c\rangle  = 
\frac{1}{2!}\langle c |\left( \hat{V}_N \{a^\dagger_a a_i\} \{a^\dagger_b a_j\} \right)^{\dagger} | c\rangle 
$$

which is nothing but
$$
\frac{1}{2!}\langle c |  \left( \hat{V}_N \{a^\dagger_a a_i\} \{a^\dagger_b a_j\} \right) | c\rangle^*
=\frac{1}{2} \sum_{ijab} (\langle ij|\hat{v}|ab\rangle)^*\delta C_{ai}^*\delta C_{bj}^*
$$

or 
$$
\frac{1}{2} \sum_{ijab} (\langle ab|\hat{v}|ij\rangle)\delta C_{ai}^*\delta C_{bj}^*
$$

where we have used the relation
$$ 
\langle a |\hat{A} | b\rangle =  (\langle b |\hat{A}^{\dagger} | a\rangle)^*
$$

due to the hermiticity of \( \hat{H} \) and \( \hat{V} \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec69">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We define two matrix elements
$$
A_{ai,bj}=-\langle aj|\hat{v} bi\rangle
$$

and
$$
B_{ai,bj}=\langle ab|\hat{v}|ij\rangle
$$

both being anti-symmetrized.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec70">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
With these definitions we write out the energy as
$$
\begin{align}
\langle c'|H|c'\rangle& = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+\sum_{ai}|\delta C_{ai}|^2(\varepsilon_a^{HF}-\varepsilon_i^{HF})+\sum_{ijab}A_{ai,bj}\delta C_{ai}^*\delta C_{bj}+
\label{_auto9}\\
&\frac{1}{2} \sum_{ijab} B_{ai,bj}^*\delta C_{ai}\delta C_{bj}+\frac{1}{2} \sum_{ijab} B_{ai,bj}\delta C_{ai}^*\delta C_{bj}^*
+O(\delta C_{ai}^3),
\label{_auto10}
\end{align}
$$

which can be rewritten as
$$
\langle c'|H|c'\rangle = \left(1+\sum_{ai}|\delta C_{ai}|^2\right)\langle c |H|c\rangle+\Delta E+O(\delta C_{ai}^3),
$$

and skipping higher-order terms we arrived
$$
\frac{\langle c' |\hat{H} | c'\rangle}{\langle c' |c'\rangle} =E_0+\frac{\Delta E}{\left(1+\sum_{ai}|\delta C_{ai}|^2\right)}.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec71">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We have defined 
$$
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle
$$

with the vectors 
$$ 
\chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T
$$

and the matrix 
$$
\hat{M}=\left(\begin{array}{cc} \Delta + A & B \\ B^* & \Delta + A^*\end{array}\right),
$$

with \( \Delta_{ai,bj} = (\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij} \).


</div>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec72">Hartree-Fock in second quantization and stability of HF solution </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The condition
$$
\Delta E = \frac{1}{2} \langle \chi | \hat{M}| \chi \rangle \ge 0
$$

for an arbitrary  vector 
$$ 
\chi = \left[ \delta C\hspace{0.2cm} \delta C^*\right]^T
$$

means that all eigenvalues of the matrix have to be larger than or equal zero. 
A necessary (but no sufficient) condition is that the matrix elements (for all \( ai \) )
$$
(\varepsilon_a-\varepsilon_i)\delta_{ab}\delta_{ij}+A_{ai,bj} \ge 0.
$$

This equation can be used as a first test of the stability of the Hartree-Fock equation.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec73">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In the build-up of a shell-model or FCI code that is meant to tackle large dimensionalities
is the action of the Hamiltonian \( \hat{H} \) on a
Slater determinant represented in second quantization as
$$
 |\alpha_1\dots \alpha_n\rangle = a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
$$

The time consuming part stems from the action of the Hamiltonian
on the above determinant,
$$
\left(\sum_{\alpha\beta} \langle \alpha|t+u|\beta\rangle a_\alpha^{\dagger} a_\beta + \frac{1}{4} \sum_{\alpha\beta\gamma\delta}
                \langle \alpha \beta|\hat{v}|\gamma \delta\rangle a_\alpha^{\dagger} a_\beta^{\dagger} a_\delta a_\gamma\right)a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \dots a_{\alpha_n}^{\dagger} |0\rangle.
$$

A practically useful way to implement this action is to encode a Slater determinant as a bit pattern.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec74">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Assume that we have at our disposal \( n \) different single-particle orbits
\( \alpha_0,\alpha_2,\dots,\alpha_{n-1} \) and that we can distribute  among these orbits \( N\le n \) particles.

<p>
A Slater  determinant can then be coded as an integer of \( n \) bits. As an example, if we have \( n=16 \) single-particle states
\( \alpha_0,\alpha_1,\dots,\alpha_{15} \) and \( N=4 \) fermions occupying the states \( \alpha_3 \), \( \alpha_6 \), \( \alpha_{10} \) and \( \alpha_{13} \)
we could write this Slater determinant as  
$$
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle.
$$

The unoccupied single-particle states have bit value \( 0 \) while the occupied ones are represented by bit state \( 1 \). 
In the binary notation we would write this   16 bits long integer as
$$
\begin{array}{cccccccccccccccc}
{\alpha_0}&{\alpha_1}&{\alpha_2}&{\alpha_3}&{\alpha_4}&{\alpha_5}&{\alpha_6}&{\alpha_7} & {\alpha_8} &{\alpha_9} & {\alpha_{10}} &{\alpha_{11}} &{\alpha_{12}} &{\alpha_{13}} &{\alpha_{14}} & {\alpha_{15}} \\
{0} & {0} &{0} &{1} &{0} &{0} &{1} &{0} &{0} &{0} &{1} &{0} &{0} &{1} &{0} & {0} \\
\end{array}
$$

which translates into the decimal number
$$
2^3+2^6+2^{10}+2^{13}=9288.
$$

We can thus encode a Slater determinant as a bit pattern.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec75">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
With \( N \) particles that can be distributed over \( n \) single-particle states, the total number of Slater determinats (and defining thereby the dimensionality of the system) is
$$
\mathrm{dim}(\mathcal{H}) = \left(\begin{array}{c} n \\N\end{array}\right).
$$

The total number of bit patterns is \( 2^n \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec76">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We assume again that we have at our disposal \( n \) different single-particle orbits
\( \alpha_0,\alpha_2,\dots,\alpha_{n-1} \) and that we can distribute  among these orbits \( N\le n \) particles.
The ordering among these states is important as it defines the order of the creation operators.
We will write the determinant 
$$
\Phi_{\Lambda} = a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
$$

in a more compact way as 
$$
\Phi_{3,6,10,13} = |0001001000100100\rangle.
$$

The action of a creation operator is thus
$$
a^{\dagger}_{\alpha_4}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
$$

which becomes
$$
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec77">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Similarly
$$
a^{\dagger}_{\alpha_6}\Phi_{3,6,10,13} = a^{\dagger}_{\alpha_6}|0001001000100100\rangle=a^{\dagger}_{\alpha_6}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
$$

which becomes
$$
-a^{\dagger}_{\alpha_4} (a_{\alpha_6}^{\dagger})^ 2 a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=0!
$$

This gives a simple recipe:  

<ul>
<li> If one of the bits \( b_j \) is \( 1 \) and we act with a creation operator on this bit, we return a null vector</li>
<li> If \( b_j=0 \), we set it to \( 1 \) and return a sign factor \( (-1)^l \), where \( l \) is the number of bits set before bit \( j \).</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec78">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Consider the action of \( a^{\dagger}_{\alpha_2} \) on various slater determinants:
$$
\begin{array}{ccc}
a^{\dagger}_{\alpha_2}\Phi_{00111}& = a^{\dagger}_{\alpha_2}|00111\rangle&=0\times |00111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01011}& = a^{\dagger}_{\alpha_2}|01011\rangle&=(-1)\times |01111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01101}& = a^{\dagger}_{\alpha_2}|01101\rangle&=0\times |01101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{01110}& = a^{\dagger}_{\alpha_2}|01110\rangle&=0\times |01110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10011}& = a^{\dagger}_{\alpha_2}|10011\rangle&=(-1)\times |10111\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10101}& = a^{\dagger}_{\alpha_2}|10101\rangle&=0\times |10101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{10110}& = a^{\dagger}_{\alpha_2}|10110\rangle&=0\times |10110\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11001}& = a^{\dagger}_{\alpha_2}|11001\rangle&=(+1)\times |11101\rangle\\
a^{\dagger}_{\alpha_2}\Phi_{11010}& = a^{\dagger}_{\alpha_2}|11010\rangle&=(+1)\times |11110\rangle\\
\end{array}
$$

What is the simplest way to obtain the phase when we act with one annihilation(creation) operator
on the given Slater determinant representation?
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec79">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We have an SD representation
$$
\Phi_{\Lambda} = a_{\alpha_0}^{\dagger} a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
$$

in a more compact way as
$$
\Phi_{0,3,6,10,13} = |1001001000100100\rangle.
$$

The action of
$$
a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13} = a^{\dagger}_{\alpha_4}|0001001000100100\rangle=a^{\dagger}_{\alpha_4}a_{\alpha_3}^{\dagger} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle,
$$

which becomes
$$
-a_{\alpha_3}^{\dagger} a^{\dagger}_{\alpha_4} a_{\alpha_6}^{\dagger} a_{\alpha_{10}}^{\dagger} a_{\alpha_{13}}^{\dagger} |0\rangle=-|0001101000100100\rangle.
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec80">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The action
$$
a_{\alpha_0}\Phi_{0,3,6,10,13} = |0001001000100100\rangle,
$$

can be obtained by subtracting the logical sum (AND operation) of \( \Phi_{0,3,6,10,13} \) and 
a word which represents only \( \alpha_0 \), that is
$$
|1000000000000000\rangle,
$$

from \( \Phi_{0,3,6,10,13}= |1001001000100100\rangle \).

<p>
This operation gives \( |0001001000100100\rangle \).

<p>
Similarly, we can form \( a^{\dagger}_{\alpha_4}a_{\alpha_0}\Phi_{0,3,6,10,13} \), say, by adding 
\( |0000100000000000\rangle \) to \( a_{\alpha_0}\Phi_{0,3,6,10,13} \), first checking that their logical sum
is zero in order to make sure that orbital \( \alpha_4 \) is not already occupied.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec81">Operators in second quantization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
It is trickier however to get the phase \( (-1)^l \). 
One possibility is as follows

<ul>
<li> Let \( S_1 \) be a word that represents the $1-$bit to be removed and all others set to zero.</li>
</ul>

In the previous example \( S_1=|1000000000000000\rangle \)

<ul>
<li> Define \( S_2 \) as the similar word that represents the bit to be added, that is in our case</li>
</ul>

\( S_2=|0000100000000000\rangle \).

<ul>
<li> Compute then \( S=S_1-S_2 \), which here becomes</li>
</ul>

$$
S=|0111000000000000\rangle
$$


<ul>
<li> Perform then the logical AND operation of \( S \) with the word containing</li> 
</ul>

$$
\Phi_{0,3,6,10,13} = |1001001000100100\rangle,
$$

which results in \( |0001000000000000\rangle \). Counting the number of $1-$bits gives the phase.  Here you need however an algorithm for bitcounting. Several efficient ones available.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec82">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 1.</b>
<p>
This exercise serves to convince you about the relation between
two different single-particle bases, where one could be our new Hartree-Fock basis and the other a harmonic oscillator basis.

<p>
Consider a Slater determinant built up of single-particle orbitals \( \psi_{\lambda} \), 
with \( \lambda = 1,2,\dots,A \). The unitary transformation
$$
\psi_a  = \sum_{\lambda} C_{a\lambda}\phi_{\lambda},
$$

brings us into the new basis.  
The new basis has quantum numbers \( a=1,2,\dots,A \).
Show that the new basis is orthonormal.
Show that the new Slater determinant constructed from the new single-particle wave functions can be
written as the determinant based on the previous basis and the determinant of the matrix \( C \).
Show that the old and the new Slater determinants are equal up to a complex constant with absolute value unity.
(Hint, \( C \) is a unitary matrix).

<p>
Starting with the second quantization representation of the Slater determinant 
$$
\Phi_{0}=\prod_{i=1}^{n}a_{\alpha_{i}}^{\dagger}|0\rangle,
$$

use Wick's theorem to compute the normalization integral
\( \langle\Phi_{0}|\Phi_{0}\rangle \).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec83">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 2.</b>
<p>
Calculate the matrix elements
$$
\langle \alpha_{1}\alpha_{2}|\hat{F}|\alpha_{1}\alpha_{2}\rangle
$$

and
$$
\langle \alpha_{1}\alpha_{2}|\hat{G}|\alpha_{1}\alpha_{2}\rangle
$$

with
$$
|\alpha_{1}\alpha_{2}\rangle=a_{\alpha_{1}}^{\dagger}a_{\alpha_{2}}^{\dagger}|0\rangle ,
$$

$$
\hat{F}=\sum_{\alpha\beta}\langle \alpha|\hat{f}|\beta\rangle
a_{\alpha}^{\dagger}a_{\beta}  ,
$$

$$
\langle \alpha|\hat{f}|\beta\rangle=\int \psi_{\alpha}^{*}(x)f(x)\psi_{\beta}(x)dx ,
$$

$$
\hat{G} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle
a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma} ,
$$

and
$$
\langle \alpha\beta |\hat{g}|\gamma\delta\rangle=
\int\int \psi_{\alpha}^{*}(x_{1})\psi_{\beta}^{*}(x_{2})g(x_{1},
x_{2})\psi_{\gamma}(x_{1})\psi_{\delta}(x_{2})dx_{1}dx_{2}
$$

Compare these results with those from exercise 3c).
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec84">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 3.</b>
<p>
Show that the onebody part of the Hamiltonian
$$	     
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle a^{\dagger}_p a_q,
$$

can be written, using standard annihilation and creation operators, in normal-ordered form as 
$$
\hat{H}_0 = \sum_{pq} \langle p|\hat{h}_0|q\rangle \left\{a^\dagger_p a_q\right\} +
             \sum_i \langle i|\hat{h}_0|i\rangle.
$$

Explain the meaning of the various symbols. Which reference 
vacuum has been used?
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec85">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 4.</b>
<p>
Show that the twobody part of the Hamiltonian
$$
  \hat{H}_I = \frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle a^\dagger_p a^\dagger_q a_s  a_r,
$$

can be written, using standard annihilation and creation operators, in normal-ordered form as 
$$
\hat{H}_I =\frac{1}{4} \sum_{pqrs} \langle pq|\hat{v}|rs\rangle \left\{a^\dagger_p a^\dagger_q a_s  a_r\right\}
            + \sum_{pqi} \langle pi|\hat{v}|qi\rangle \left\{a^\dagger_p a_q\right\} 
            + \frac{1}{2} \sum_{ij}\langle ij|\hat{v}|ij\rangle.
$$

Explain again the meaning of the various symbols.

<p>
This exercise is optional: Derive the normal-ordered form of the threebody part of the Hamiltonian.
$$
\hat{H}_3 = \frac{1}{36} \sum_{\substack{pqr \\ stu}}
                 \langle pqr|\hat{v}_3|stu\rangle a^\dagger_p a^\dagger_q a^\dagger_r a_u a_t a_s,
$$

and specify the contributions to the twobody, onebody and the scalar part.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec86">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 5.</b>
<p>

<p>
The aim of this exercise is to set up specific matrix elements that will turn useful when we start our discussions of the nuclear shell model. In particular you will notice, depending on the character of the operator, that many matrix elements will actually be zero.

<p>
Consider three \( N \)-particle  Slater determinants  \( |\Phi_0 \), \( |\Phi_i^a\rangle \) and \( |\Phi_{ij}^{ab}\rangle \), where the notation means that 
Slater determinant \( |\Phi_i^a\rangle \) differs from \( |\Phi_0\rangle \) by one single-particle state, that is a single-particle
state \( \psi_i \) is replaced by a single-particle state \( \psi_a \). 
It is often interpreted as a so-called one-particle-one-hole excitation.
Similarly, the Slater determinant \( |\Phi_{ij}^{ab}\rangle \)
differs by two single-particle states from \( |\Phi_0\rangle \) and is normally thought of as a two-particle-two-hole excitation.
We assume also that \( |\Phi_0\rangle \) represents our new vacuum reference state
and the labels \( ijk\dots \) represent single-particle states below the Fermi level and \( abc\dots \) represent states above the Fermi level, so-called particle states.
We define thereafter a general onebody normal-ordered (with respect to the new vacuum state) operator 
as
$$
\hat{F}_N=\sum_{pq}\langle p |f |\beta\rangle \left\{a_{p}^{\dagger}a_{q}\right\}  ,
$$

with
$$
\langle p |f| q\rangle=\int \psi_{p}^{*}(x)f(x)\psi_{q}(x)dx ,
$$

and a general normal-ordered two-body operator
$$
\hat{G}_N = \frac{1}{4}\sum_{pqrs}
\langle pq |g| rs\rangle_{AS} \left\{a_{p}^{\dagger}a_{q}^{\dagger}a_{s}a_{r}\right\} ,
$$

with for example the direct matrix element given as
$$
\langle pq |g| rs\rangle=
\int\int \psi_{p}^{*}(x_{1})\psi_{q}^{*}(x_{2})g(x_{1}, x_{2})\psi_{r}(x_{1})\psi_{s}(x_{2})dx_{1}dx_{2}
$$

with \( g \) being invariant under the interchange of the coordinates of two particles.
The single-particle states \( \psi_i \) are not necessarily eigenstates of \( \hat{f} \).  The curly brackets mean that the operators are normal-ordered with respect to the new vacuum reference state.

<p>
How would you write the above Slater determinants in a second quantization formalism, utilizing the fact that we have defined a new reference state?

<p>
Use thereafter Wick's theorem to find the expectation values of 
$$
\langle \Phi_0 \vert\hat{F}_N\vert\Phi_0\rangle,
$$

and
$$
\langle \Phi_0\hat{G}_N|\Phi_0\rangle.
$$

<p>
Find thereafter 
$$
\langle \Phi_0 |\hat{F}_N|\Phi_i^a\rangle,
$$

and
$$
\langle \Phi_0|\hat{G}_N|\Phi_i^a\rangle,
$$

Finally, find
$$
\langle \Phi_0 |\hat{F}_N|\Phi_{ij}^{ab}\rangle,
$$

and
$$
\langle \Phi_0|\hat{G}_N|\Phi_{ij}^{ab}\rangle.
$$

What happens with the two-body operator if we have a transition probability  of the type
$$
\langle \Phi_0|\hat{G}_N|\Phi_{ijk}^{abc}\rangle,
$$

where the Slater determinant to the right of the operator differs by more than two single-particle states?


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec87">Exercises </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 6.</b>
<p>

<p>
Write a program which sets up all possible Slater determinants given \( N=4 \) eletrons which can occupy
the atomic single-particle states defined by the \( 1s \), \( 2s2p \) and \( 3s3p3d \) shells. How many single-particle
states \( n \) are there in total?  Include the spin degrees of freedom as well.
We include here a python program which may aid in this direction. It uses bit manipulation functions from <a href="http://wiki.python.org/moin/BitManipulation" target="_blank"><tt>http://wiki.python.org/moin/BitManipulation</tt></a>.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">math</span>

<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">A simple Python class for Slater determinant manipulation</span>
<span style="color: #BA2121; font-style: italic">Bit-manipulation stolen from:</span>

<span style="color: #BA2121; font-style: italic">http://wiki.python.org/moin/BitManipulation</span>
<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>

<span style="color: #408080; font-style: italic"># bitCount() counts the number of bits set (not an optimal function)</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bitCount</span>(int_type):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; Count bits set in integer &quot;&quot;&quot;</span>
    count <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">while</span>(int_type):
        int_type <span style="color: #666666">&amp;=</span> int_type <span style="color: #666666">-</span> <span style="color: #666666">1</span>
        count <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span>(count)


<span style="color: #408080; font-style: italic"># testBit() returns a nonzero result, 2**offset, if the bit at &#39;offset&#39; is one.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">testBit</span>(int_type, offset):
    mask <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;&lt;</span> offset
    <span style="color: #008000; font-weight: bold">return</span>(int_type <span style="color: #666666">&amp;</span> mask) <span style="color: #666666">&gt;&gt;</span> offset

<span style="color: #408080; font-style: italic"># setBit() returns an integer with the bit at &#39;offset&#39; set to 1.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">setBit</span>(int_type, offset):
    mask <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;&lt;</span> offset
    <span style="color: #008000; font-weight: bold">return</span>(int_type <span style="color: #666666">|</span> mask)

<span style="color: #408080; font-style: italic"># clearBit() returns an integer with the bit at &#39;offset&#39; cleared.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">clearBit</span>(int_type, offset):
    mask <span style="color: #666666">=</span> <span style="color: #666666">~</span>(<span style="color: #666666">1</span> <span style="color: #666666">&lt;&lt;</span> offset)
    <span style="color: #008000; font-weight: bold">return</span>(int_type <span style="color: #666666">&amp;</span> mask)

<span style="color: #408080; font-style: italic"># toggleBit() returns an integer with the bit at &#39;offset&#39; inverted, 0 -&gt; 1 and 1 -&gt; 0.</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">toggleBit</span>(int_type, offset):
    mask <span style="color: #666666">=</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;&lt;</span> offset
    <span style="color: #008000; font-weight: bold">return</span>(int_type <span style="color: #666666">^</span> mask)

<span style="color: #408080; font-style: italic"># binary string made from number</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bin0</span>(s):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">str</span>(s) <span style="color: #008000; font-weight: bold">if</span> s<span style="color: #666666">&lt;=1</span> <span style="color: #008000; font-weight: bold">else</span> bin0(s<span style="color: #666666">&gt;&gt;1</span>) <span style="color: #666666">+</span> <span style="color: #008000">str</span>(s<span style="color: #666666">&amp;1</span>)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">bin</span>(s, L <span style="color: #666666">=</span> <span style="color: #666666">0</span>):
    ss <span style="color: #666666">=</span> bin0(s)
    <span style="color: #008000; font-weight: bold">if</span> L <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;0&#39;</span><span style="color: #666666">*</span>(L<span style="color: #666666">-</span><span style="color: #008000">len</span>(ss)) <span style="color: #666666">+</span> ss
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> ss
    
    

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Slater</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; Class for Slater determinants &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>word <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #666666">0</span>)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">create</span>(<span style="color: #008000">self</span>, j):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;c^+_&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">str</span>(j) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; |&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">bin</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>word) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;&gt;  = &quot;</span>,
        <span style="color: #408080; font-style: italic"># Assume bit j is set, then we return zero.</span>
        s <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #408080; font-style: italic"># Check if bit j is set.</span>
        isset <span style="color: #666666">=</span> testBit(<span style="color: #008000">self</span><span style="color: #666666">.</span>word, j)
        <span style="color: #008000; font-weight: bold">if</span> isset <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            bits <span style="color: #666666">=</span> bitCount(<span style="color: #008000">self</span><span style="color: #666666">.</span>word <span style="color: #666666">&amp;</span> ((<span style="color: #666666">1&lt;&lt;</span>j)<span style="color: #666666">-1</span>))
            s <span style="color: #666666">=</span> <span style="color: #008000">pow</span>(<span style="color: #666666">-1</span>, bits)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>word <span style="color: #666666">=</span> setBit(<span style="color: #008000">self</span><span style="color: #666666">.</span>word, j)

        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #008000">str</span>(s) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; x |&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">bin</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>word) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;&gt;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> s
        
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">annihilate</span>(<span style="color: #008000">self</span>, j):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;c_&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">str</span>(j) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; |&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">bin</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>word) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;&gt;  = &quot;</span>,
        <span style="color: #408080; font-style: italic"># Assume bit j is not set, then we return zero.</span>
        s <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #408080; font-style: italic"># Check if bit j is set.</span>
        isset <span style="color: #666666">=</span> testBit(<span style="color: #008000">self</span><span style="color: #666666">.</span>word, j)
        <span style="color: #008000; font-weight: bold">if</span> isset <span style="color: #666666">==</span> <span style="color: #666666">1</span>:
            bits <span style="color: #666666">=</span> bitCount(<span style="color: #008000">self</span><span style="color: #666666">.</span>word <span style="color: #666666">&amp;</span> ((<span style="color: #666666">1&lt;&lt;</span>j)<span style="color: #666666">-1</span>))
            s <span style="color: #666666">=</span> <span style="color: #008000">pow</span>(<span style="color: #666666">-1</span>, bits)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>word <span style="color: #666666">=</span> clearBit(<span style="color: #008000">self</span><span style="color: #666666">.</span>word, j)

        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #008000">str</span>(s) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; x |&quot;</span> <span style="color: #666666">+</span> <span style="color: #008000">bin</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>word) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;&gt;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> s



<span style="color: #408080; font-style: italic"># Do some testing:</span>

phi <span style="color: #666666">=</span> Slater()
phi<span style="color: #666666">.</span>create(<span style="color: #666666">0</span>)
phi<span style="color: #666666">.</span>create(<span style="color: #666666">1</span>)
phi<span style="color: #666666">.</span>create(<span style="color: #666666">2</span>)
phi<span style="color: #666666">.</span>create(<span style="color: #666666">3</span>)

<span style="color: #008000; font-weight: bold">print</span>


s <span style="color: #666666">=</span> phi<span style="color: #666666">.</span>annihilate(<span style="color: #666666">2</span>)
s <span style="color: #666666">=</span> phi<span style="color: #666666">.</span>create(<span style="color: #666666">7</span>)
s <span style="color: #666666">=</span> phi<span style="color: #666666">.</span>annihilate(<span style="color: #666666">0</span>)
s <span style="color: #666666">=</span> phi<span style="color: #666666">.</span>create(<span style="color: #666666">200</span>)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec88">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 7.</b>
<p>
Compute the matrix element
$$
\langle\alpha_{1}\alpha_{2}\alpha_{3}|\hat{G}|\alpha_{1}'\alpha_{2}'\alpha_{3}'\rangle,
$$

using Wick's theorem and express the two-body operator
\( G \) in the occupation number (second quantization) 
representation.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec89">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The last exercise can be solved using the symbolic Python package called <em>SymPy</em>. SymPy is a Python 
package for general purpose symbolic algebra. There is a physics module with several interesting submodules.
Among these, the submodule called <em>secondquant</em>, contains several  functionalities that allow us to test
our algebraic manipulations using Wick's theorem and operators for second quantization.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>

i, j <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;i,j&#39;</span>, below_fermi<span style="color: #666666">=</span><span style="color: #008000">True</span>)
a, b <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;a,b&#39;</span>, above_fermi<span style="color: #666666">=</span><span style="color: #008000">True</span>)
p, q <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p,q&#39;</span>)
<span style="color: #008000; font-weight: bold">print</span> simplify(wicks(Fd(i)<span style="color: #666666">*</span>F(a)<span style="color: #666666">*</span>Fd(p)<span style="color: #666666">*</span>F(q)<span style="color: #666666">*</span>Fd(b)<span style="color: #666666">*</span>F(j), keep_only_fully_contracted<span style="color: #666666">=</span><span style="color: #008000">True</span>))
</pre></div>
<p>
The code defines single-particle states above and below the Fermi level, in addition to the genereal symbols
\( pq \) which can refer to any type of state below or above the Fermi level. Wick's theorem is implemented between 
the creation and annihilation operators <em>Fd</em> and <em>F</em>, respectively. Using the simplify option, one can lump together several Kronecker-\( \delta \) functions.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec90">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can expand the above Python code by defining one-body and two-body operators using  the following SymPy code 
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># This code sets up a two-body Hamiltonian for fermions</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> symbols, latex, WildFunction, collect, Rational
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> F, Fd, wicks, AntiSymmetricTensor, substitute_dummies, NO

<span style="color: #408080; font-style: italic"># setup hamiltonian</span>
p,q,r,s <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p q r s&#39;</span>,dummy<span style="color: #666666">=</span><span style="color: #008000">True</span>)
f <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;f&#39;</span>,(p,),(q,))
pr <span style="color: #666666">=</span> NO((Fd(p)<span style="color: #666666">*</span>F(q)))
v <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;v&#39;</span>,(p,q),(r,s))
pqsr <span style="color: #666666">=</span> NO(Fd(p)<span style="color: #666666">*</span>Fd(q)<span style="color: #666666">*</span>F(s)<span style="color: #666666">*</span>F(r))
Hamiltonian<span style="color: #666666">=</span>f<span style="color: #666666">*</span>pr <span style="color: #666666">+</span> Rational(<span style="color: #666666">1</span>)<span style="color: #666666">/</span>Rational(<span style="color: #666666">4</span>)<span style="color: #666666">*</span>v<span style="color: #666666">*</span>pqsr
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Hamiltonian defined as:&quot;</span>, latex(Hamiltonian)
</pre></div>
<p>
Here we have used the <em>AntiSymmetricTensor</em> functionality, together with normal-ordering defined by the <em>NO</em> function. 
Using the <em>latex</em> option, this program produces the following output
$$
f^{p}_{q} \left\{a^\dagger_{p} a_{q}\right\} - \frac{1}{4} v^{qp}_{sr} \left\{a^\dagger_{p} a^\dagger_{q} a_{r} a_{s}\right\}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec91">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can now use this code to compute the matrix elements between two two-body Slater determinants using Wick's theorem.
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> symbols, latex, WildFunction, collect, Rational, simplify
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> F, Fd, wicks, AntiSymmetricTensor, substitute_dummies, NO, evaluate_deltas
<span style="color: #408080; font-style: italic"># setup hamiltonian</span>
p,q,r,s <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p q r s&#39;</span>,dummy<span style="color: #666666">=</span><span style="color: #008000">True</span>)
f <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;f&#39;</span>,(p,),(q,))
pr <span style="color: #666666">=</span> NO((Fd(p)<span style="color: #666666">*</span>F(q)))
v <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;v&#39;</span>,(p,q),(r,s))
pqsr <span style="color: #666666">=</span> NO(Fd(p)<span style="color: #666666">*</span>Fd(q)<span style="color: #666666">*</span>F(s)<span style="color: #666666">*</span>F(r))
Hamiltonian<span style="color: #666666">=</span>f<span style="color: #666666">*</span>pr <span style="color: #666666">+</span> Rational(<span style="color: #666666">1</span>)<span style="color: #666666">/</span>Rational(<span style="color: #666666">4</span>)<span style="color: #666666">*</span>v<span style="color: #666666">*</span>pqsr
c,d <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;c, d&#39;</span>,above_fermi<span style="color: #666666">=</span><span style="color: #008000">True</span>)
a,b <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;a, b&#39;</span>,above_fermi<span style="color: #666666">=</span><span style="color: #008000">True</span>)

expression <span style="color: #666666">=</span> wicks(F(b)<span style="color: #666666">*</span>F(a)<span style="color: #666666">*</span>Hamiltonian<span style="color: #666666">*</span>Fd(c)<span style="color: #666666">*</span>Fd(d),keep_only_fully_contracted<span style="color: #666666">=</span><span style="color: #008000">True</span>, simplify_kronecker_deltas<span style="color: #666666">=</span><span style="color: #008000">True</span>)
expression <span style="color: #666666">=</span> evaluate_deltas(expression)
expression <span style="color: #666666">=</span> simplify(expression)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Hamiltonian defined as:&quot;</span>, latex(expression)
</pre></div>
<p>
The result is as expected,
$$
\delta_{a c} f^{b}_{d} - \delta_{a d} f^{b}_{c} - \delta_{b c} f^{a}_{d} + \delta_{b d} f^{a}_{c} + v^{ab}_{cd}.
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec92">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can continue along these lines and define a normal-ordered Hamiltonian with respect to a given reference state.
In our first step we just define the Hamiltonian
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> symbols, latex, WildFunction, collect, Rational, simplify
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> F, Fd, wicks, AntiSymmetricTensor, substitute_dummies, NO, evaluate_deltas
<span style="color: #408080; font-style: italic"># setup hamiltonian</span>
p,q,r,s <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p q r s&#39;</span>,dummy<span style="color: #666666">=</span><span style="color: #008000">True</span>)
f <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;f&#39;</span>,(p,),(q,))
pr <span style="color: #666666">=</span> Fd(p)<span style="color: #666666">*</span>F(q)
v <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;v&#39;</span>,(p,q),(r,s))
pqsr <span style="color: #666666">=</span> Fd(p)<span style="color: #666666">*</span>Fd(q)<span style="color: #666666">*</span>F(s)<span style="color: #666666">*</span>F(r)
<span style="color: #408080; font-style: italic">#define the Hamiltonian</span>
Hamiltonian <span style="color: #666666">=</span> f<span style="color: #666666">*</span>pr <span style="color: #666666">+</span> Rational(<span style="color: #666666">1</span>)<span style="color: #666666">/</span>Rational(<span style="color: #666666">4</span>)<span style="color: #666666">*</span>v<span style="color: #666666">*</span>pqsr
<span style="color: #408080; font-style: italic">#define indices for states above and below the Fermi level</span>
index_rule <span style="color: #666666">=</span> {
     <span style="color: #BA2121">&#39;below&#39;</span>:  <span style="color: #BA2121">&#39;kl&#39;</span>,
     <span style="color: #BA2121">&#39;above&#39;</span>:  <span style="color: #BA2121">&#39;cd&#39;</span>,
     <span style="color: #BA2121">&#39;general&#39;</span>: <span style="color: #BA2121">&#39;pqrs&#39;</span>
     }
Hnormal <span style="color: #666666">=</span> substitute_dummies(Hamiltonian,new_indices<span style="color: #666666">=</span><span style="color: #008000">True</span>, pretty_indices<span style="color: #666666">=</span>index_rule)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Hamiltonian defined as:&quot;</span>, latex(Hnormal)
</pre></div>
<p>
which results in
$$
f^{q}_{p} a^\dagger_{q} a_{p} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{s} a^\dagger_{r} a_{p} a_{q}
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec93">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In our next step we define the reference energy \( E_0 \) and redefine the Hamiltonian by subtracting the reference energy and collecting the coefficients for all normal-ordered products (given by the <em>NO</em> function).
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> symbols, latex, WildFunction, collect, Rational, simplify
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> F, Fd, wicks, AntiSymmetricTensor, substitute_dummies, NO, evaluate_deltas
<span style="color: #408080; font-style: italic"># setup hamiltonian</span>
p,q,r,s <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p q r s&#39;</span>,dummy<span style="color: #666666">=</span><span style="color: #008000">True</span>)
f <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;f&#39;</span>,(p,),(q,))
pr <span style="color: #666666">=</span> Fd(p)<span style="color: #666666">*</span>F(q)
v <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;v&#39;</span>,(p,q),(r,s))
pqsr <span style="color: #666666">=</span> Fd(p)<span style="color: #666666">*</span>Fd(q)<span style="color: #666666">*</span>F(s)<span style="color: #666666">*</span>F(r)
<span style="color: #408080; font-style: italic">#define the Hamiltonian</span>
Hamiltonian<span style="color: #666666">=</span>f<span style="color: #666666">*</span>pr <span style="color: #666666">+</span> Rational(<span style="color: #666666">1</span>)<span style="color: #666666">/</span>Rational(<span style="color: #666666">4</span>)<span style="color: #666666">*</span>v<span style="color: #666666">*</span>pqsr
<span style="color: #408080; font-style: italic">#define indices for states above and below the Fermi level</span>
index_rule <span style="color: #666666">=</span> {
     <span style="color: #BA2121">&#39;below&#39;</span>:  <span style="color: #BA2121">&#39;kl&#39;</span>,
     <span style="color: #BA2121">&#39;above&#39;</span>:  <span style="color: #BA2121">&#39;cd&#39;</span>,
     <span style="color: #BA2121">&#39;general&#39;</span>: <span style="color: #BA2121">&#39;pqrs&#39;</span>
     }
Hnormal <span style="color: #666666">=</span> substitute_dummies(Hamiltonian,new_indices<span style="color: #666666">=</span><span style="color: #008000">True</span>, pretty_indices<span style="color: #666666">=</span>index_rule)
E0 <span style="color: #666666">=</span> wicks(Hnormal,keep_only_fully_contracted<span style="color: #666666">=</span><span style="color: #008000">True</span>)
Hnormal <span style="color: #666666">=</span> Hnormal<span style="color: #666666">-</span>E0
w <span style="color: #666666">=</span> WildFunction(<span style="color: #BA2121">&#39;w&#39;</span>)
Hnormal <span style="color: #666666">=</span> collect(Hnormal, NO(w))
Hnormal <span style="color: #666666">=</span> evaluate_deltas(Hnormal)
<span style="color: #008000; font-weight: bold">print</span> latex(Hnormal)
</pre></div>
<p>
which gives us 
$$
- f^{i}_{i} + f^{q}_{p} a^\dagger_{q} a_{p} - \frac{1}{4} v^{ii}_{ii} - \frac{1}{4} v^{ii}_{ii} + \frac{1}{4} v^{sr}_{qp} a^\dagger_{r} a^\dagger_{s} a_{q} a_{p},
$$

again as expected, with the reference energy to be subtracted.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec94">Exercises: Using sympy to compute matrix elements  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We can now go back to exercise 7 and define the Hamiltonian and the second-quantized representation of a  three-body Slater determinant. 
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> symbols, latex, WildFunction, collect, Rational, simplify
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy.physics.secondquant</span> <span style="color: #008000; font-weight: bold">import</span> F, Fd, wicks, AntiSymmetricTensor, substitute_dummies, NO, evaluate_deltas
<span style="color: #408080; font-style: italic"># setup hamiltonian</span>
p,q,r,s <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;p q r s&#39;</span>,dummy<span style="color: #666666">=</span><span style="color: #008000">True</span>)

v <span style="color: #666666">=</span> AntiSymmetricTensor(<span style="color: #BA2121">&#39;v&#39;</span>,(p,q),(r,s))
pqsr <span style="color: #666666">=</span> NO(Fd(p)<span style="color: #666666">*</span>Fd(q)<span style="color: #666666">*</span>F(s)<span style="color: #666666">*</span>F(r))
Hamiltonian<span style="color: #666666">=</span>Rational(<span style="color: #666666">1</span>)<span style="color: #666666">/</span>Rational(<span style="color: #666666">4</span>)<span style="color: #666666">*</span>v<span style="color: #666666">*</span>pqsr
a,b,c,d,e,f <span style="color: #666666">=</span> symbols(<span style="color: #BA2121">&#39;a,b, c, d, e, f&#39;</span>,above_fermi<span style="color: #666666">=</span><span style="color: #008000">True</span>)

expression <span style="color: #666666">=</span> wicks(F(c)<span style="color: #666666">*</span>F(b)<span style="color: #666666">*</span>F(a)<span style="color: #666666">*</span>Hamiltonian<span style="color: #666666">*</span>Fd(d)<span style="color: #666666">*</span>Fd(e)<span style="color: #666666">*</span>Fd(f),keep_only_fully_contracted<span style="color: #666666">=</span><span style="color: #008000">True</span>, simplify_kronecker_deltas<span style="color: #666666">=</span><span style="color: #008000">True</span>)
expression <span style="color: #666666">=</span> evaluate_deltas(expression)
expression <span style="color: #666666">=</span> simplify(expression)
<span style="color: #008000; font-weight: bold">print</span> latex(expression)
</pre></div>
<p>
resulting in nine terms (as expected), 
$$
 - \delta_{a d} v^{cb}_{ef} - \delta_{a e} v^{cb}_{fd} + \delta_{a f} v^{cb}_{ed} - \delta_{b d} v^{ac}_{ef} - \delta_{b e} v^{ac}_{fd} + \delta_{b f} v^{ac}_{ed} + \delta_{c d} v^{ab}_{ef} + \delta_{c e} v^{ab}_{fd} - \delta_{c f} v^{ab}_{ed}
$$


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec95">Exercises: Derivation of Hartree-Fock equations  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 8.</b>
<p>
What is the diagrammatic representation of the HF equation?
$$
-\langle\alpha_{k}|u^{HF}|\alpha_{i}\rangle+\sum_{j=1}^{n}
\left[\langle\alpha_{k}\alpha_{j}|\hat{v}|\alpha_{i}\alpha_{j}\rangle-
\langle\alpha_{k}\alpha_{j}|v|\alpha_{j}\alpha_{i}\rangle\right]=0
$$

(Represent \( (-u^{HF}) \) by the symbol $---$X .)
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec96">Exercises: Derivation of Hartree-Fock equations  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Exercise 9.</b>
<p>
Consider the ground state \( |\Phi\rangle \) 
of a bound many-particle system of fermions. Assume that we remove one particle
from the single-particle state \( \lambda \) and that our system ends in a new state
\( |\Phi_{n}\rangle \). 
Define the energy needed to remove this particle as
$$
E_{\lambda}=\sum_{n}\vert\langle\Phi_{n}|a_{\lambda}|\Phi\rangle\vert^{2}(E_{0}-E_{n}),
$$

where \( E_{0} \) and \( E_{n} \)  are the ground state energies of the states
\( |\Phi\rangle \)  and  \( |\Phi_{n}\rangle \), respectively.

<ul>
 <li> Show that</li>
</ul>

$$
E_{\lambda}=\langle\Phi|a_{\lambda}^{\dagger}\left[
a_{\lambda},H \right]|\Phi\rangle,
$$

where \( H \) is the Hamiltonian of this system.

<ul>
 <li> If we assume that \( \Phi \) is the  Hartree-Fock result, find the</li> 
</ul>

relation between \( E_{\lambda} \) and the single-particle energy
\( \varepsilon_{\lambda} \)
for states \( \lambda \leq F \) and \( \lambda >F \), with
$$
\varepsilon_{\lambda}=\langle\lambda|\hat{t}+\hat{u}|\lambda\rangle,
$$

and
$$
\langle\lambda|\hat{u}|\lambda\rangle=\sum_{\beta \leq F}
\langle\lambda\beta|\hat{v}|\lambda\beta\rangle.
$$

We have assumed an antisymmetrized matrix element here.
Discuss the result.

<p>
The Hamiltonian operator is defined as
$$
H=\sum_{\alpha\beta}\langle\alpha|\hat{t}|\beta\rangle a_{\alpha}^{\dagger}a_{\beta}+
\frac{1}{2}\sum_{\alpha\beta\gamma\delta}\langle\alpha\beta|\hat{v}|\gamma\delta\rangle a_{\alpha}^{\dagger}a_{\beta}^{\dagger}a_{\delta}a_{\gamma}.
$$
</div>


<p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright --> &copy; 2013-2016, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>


</body>
</html>
    

